# git commit コマンド

リポジトリに変更を記録し、インデックスの現在の内容を含む新しいコミットを作成します。

## 概要

`git commit`コマンドは、現在ステージングされているプロジェクトの変更のスナップショットを作成します。コミットされたスナップショットは、明示的に指示されない限りGitが変更しない「安全な」バージョンのプロジェクトです。コミットする前に、`git add`を使用して変更をステージングする必要があります。

## オプション

### **-m, --message=\<msg\>**

エディタを起動する代わりに、指定したメッセージをコミットメッセージとして使用します。

```console
$ git commit -m "新機能を追加"
[main 5d6e7f8] 新機能を追加
 1 file changed, 10 insertions(+), 2 deletions(-)
```

### **-a, --all**

コミットする前に、変更されたファイルと削除されたファイルを自動的にステージングします（未追跡のファイルは含まれません）。

```console
$ git commit -a -m "既存ファイルを更新"
[main 1a2b3c4] 既存ファイルを更新
 2 files changed, 5 insertions(+), 3 deletions(-)
```

### **--amend**

現在のブランチの先端を新しいコミットで置き換え、前回のコミットと同じログメッセージを使用するか、新しいメッセージを指定します。

```console
$ git commit --amend -m "前回のコミットのタイプミスを修正"
[main 8f9g0h1] 前回のコミットのタイプミスを修正
 Date: Mon May 4 10:23:45 2025 -0700
 1 file changed, 1 insertion(+), 1 deletion(-)
```

### **-v, --verbose**

コミットメッセージエディタにコミットされる変更の差分を表示します。

```console
$ git commit -v
# 差分を含むコミットメッセージテンプレートでエディタが開く
```

### **--no-verify**

pre-commitとcommit-msgフックをバイパスします。

```console
$ git commit --no-verify -m "緊急修正"
[main 2c3d4e5] 緊急修正
 1 file changed, 3 insertions(+)
```

## 使用例

### 標準的なコミットの作成

```console
$ git add file1.txt file2.txt
$ git commit -m "新しいファイルを追加"
[main 1a2b3c4] 新しいファイルを追加
 2 files changed, 15 insertions(+)
```

### 追跡されている全ての変更をコミット

```console
$ git commit -am "ドキュメントを更新"
[main 5e6f7g8] ドキュメントを更新
 3 files changed, 25 insertions(+), 10 deletions(-)
```

### 新しい変更で前回のコミットを修正

```console
$ git add forgotten_file.txt
$ git commit --amend
[main 1a2b3c4] 新しいファイルを追加
 Date: Mon May 4 09:15:32 2025 -0700
 3 files changed, 18 insertions(+)
```

## ヒント:

### 意味のあるコミットメッセージを書く

良いコミットメッセージは、どのような変更が行われ、なぜそれが行われたかを説明するべきです。現在形（「機能を追加する」であり「機能を追加した」ではない）を使用し、最初の行は50文字以内に収めましょう。

### アトミックコミットを使用する

各コミットを論理的な作業単位にしましょう。これにより、変更の理解、レビュー、必要に応じた変更の取り消しが容易になります。

### コミットする内容を確認する

コミットする前に`git diff --staged`を使用して、コミットに含まれる内容を正確に確認しましょう。

### コミットに署名する

セキュリティと検証のために、`git commit -S`を使用してGPGキーでコミットに署名することができます。

## よくある質問

#### Q1. 最後のコミットを取り消すにはどうすればよいですか？
A. 変更をステージングしたまま取り消すには`git reset HEAD~1`を、変更を完全に破棄するには`git reset --hard HEAD~1`を使用します。

#### Q2. コミット後にコミットメッセージを変更するにはどうすればよいですか？
A. まだプッシュしていない場合は、`git commit --amend`を使用して最新のコミットメッセージを修正できます。

#### Q3. `git commit`と`git commit -a`の違いは何ですか？
A. `git commit`は`git add`でステージングされた変更のみをコミットしますが、`git commit -a`は変更された追跡ファイルを自動的にステージングしてコミットします。

#### Q4. ステージングせずに直接コミットできますか？
A. はい、`git commit -a`を使用できますが、これは既に追跡されている（以前にリポジトリに追加された）ファイルに対してのみ機能します。

#### Q5. ファイルの一部だけをコミットするにはどうすればよいですか？
A. `git add -p`を使用して対話的にステージングする変更を選択し、その後通常通りコミットします。

## 参考資料

https://git-scm.com/docs/git-commit

## 改訂履歴

- 2025/05/04 初版作成