<!DOCTYPE html>
<html lang="en">
  <head>
    
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      
        <link rel="stylesheet" href="/css/reset.css" />
        <link rel="stylesheet" href="/css/main.css" />
        <link rel="stylesheet" href="/css/search.css" />
      

      
        <script src="/en/summary.js"></script>
        <script src="/js/search.js"></script>
        <script src="/js/language-switcher.js"></script>
      
      <title>
        
  ltrace - noman

      </title>

      

      
    
  </head>
  <body>
    
  <nav>
    <div class="nav-logo">
      <a href="/"><img src="../../../images/white.png" height="50px" /></a>
    </div>
    <div class="nav-right">
      <div class="nav-search">
        <input id="nav-searchbox" type="text" placeholder="Search command..." />
      </div>
      <div class="nav-links">
        <a href="/en/commandlist.html">Commands</a>
        <span id="language-switcher"></span>
      </div>
    </div>
  </nav>

  <div class="content">
    <main>
      
  <h1>ltrace command</h1>
<p>Trace library calls of a program.</p>
<h2>Overview</h2>
<p><code>ltrace</code> is a debugging utility that displays dynamic library calls made by a program. It can also show system calls and signals received by the process. This tool is particularly useful for debugging programs when source code is unavailable or for understanding how a program interacts with libraries.</p>
<h2>Options</h2>
<h3><strong>-c, --count</strong></h3>
<p>Count time and calls for each library call and report a summary at the end.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>ltrace<span style="color: #F8F8F8"> </span>-c<span style="color: #F8F8F8"> </span>ls
<span style="color: #8F5902">% </span><span style="color: #204A87">time</span><span style="color: #F8F8F8">     </span>seconds<span style="color: #F8F8F8">  </span>usecs/call<span style="color: #F8F8F8">     </span>calls<span style="color: #F8F8F8">      </span><span style="color: #204A87; font-weight: bold">function</span>
<span style="color: #000; font-style: italic">------ ----------- ----------- --------- --------------------</span>
<span style="color: #000; font-style: italic"> 21.05    0.000080          2        40 strlen</span>
<span style="color: #000; font-style: italic"> 15.79    0.000060          2        30 __ctype_b_loc</span>
<span style="color: #000; font-style: italic"> 10.53    0.000040          2        20 readdir64</span>
<span style="color: #000; font-style: italic">  7.89    0.000030          2        15 fwrite</span>
<span style="color: #000; font-style: italic">  5.26    0.000020          2        10 malloc</span>
<span style="color: #000; font-style: italic">  5.26    0.000020          2        10 free</span>
<span style="color: #000; font-style: italic">  5.26    0.000020          2        10 __errno_location</span>
<span style="color: #000; font-style: italic">  5.26    0.000020          2        10 __cxa_atexit</span>
<span style="color: #000; font-style: italic">  5.26    0.000020         20         1 opendir</span>
<span style="color: #000; font-style: italic">  5.26    0.000020         20         1 closedir</span>
<span style="color: #000; font-style: italic">  5.26    0.000020         20         1 setlocale</span>
<span style="color: #000; font-style: italic">  5.26    0.000020         20         1 isatty</span>
<span style="color: #000; font-style: italic">  2.63    0.000010         10         1 bindtextdomain</span>
<span style="color: #000; font-style: italic">------ ----------- ----------- --------- --------------------</span>
<span style="color: #000; font-style: italic">100.00    0.000380                   150 total</span>
</pre></div>
<h3><strong>-f, --follow</strong></h3>
<p>Trace child processes as they are created by the currently traced process.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>ltrace<span style="color: #F8F8F8"> </span>-f<span style="color: #F8F8F8"> </span>./program
<span style="color: #000; font-style: italic">[pid 12345] malloc(32)                                  = 0x55d7e9fa7260</span>
<span style="color: #000; font-style: italic">[pid 12345] fork()                                      = 12346</span>
<span style="color: #000; font-style: italic">[pid 12346] malloc(64)                                  = 0x55d7e9fa7290</span>
</pre></div>
<h3><strong>-e, --expr=EXPR</strong></h3>
<p>Specify the library calls to trace or filter. Format is [!][?][=][%][/@][+|-]pattern[@arch][:function].</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>ltrace<span style="color: #F8F8F8"> </span>-e<span style="color: #F8F8F8"> </span>malloc+free<span style="color: #F8F8F8"> </span>ls
<span style="color: #000; font-style: italic">ls-&gt;malloc(32)                                          = 0x55d7e9fa7260</span>
<span style="color: #000; font-style: italic">ls-&gt;malloc(64)                                          = 0x55d7e9fa7290</span>
<span style="color: #000; font-style: italic">ls-&gt;free(0x55d7e9fa7260)                                = &lt;void&gt;</span>
<span style="color: #000; font-style: italic">ls-&gt;free(0x55d7e9fa7290)                                = &lt;void&gt;</span>
</pre></div>
<h3><strong>-p, --pid=PID</strong></h3>
<p>Attach to the process with the specified PID and begin tracing.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>ltrace<span style="color: #F8F8F8"> </span>-p<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">1234</span>
<span style="color: #000; font-style: italic">[pid 1234] read(5, &quot;data&quot;, 1024)                        = 4</span>
<span style="color: #000; font-style: italic">[pid 1234] write(1, &quot;output&quot;, 6)                        = 6</span>
</pre></div>
<h3><strong>-S, --summary</strong></h3>
<p>Display a summary of library call usage at the end of the trace.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>ltrace<span style="color: #F8F8F8"> </span>-S<span style="color: #F8F8F8"> </span>ls
<span style="color: #000; font-style: italic">ls-&gt;__libc_start_main(0x401670, 1, 0x7ffd2d121768, 0x4017a0 &lt;unfinished ...&gt;</span>
<span style="color: #000; font-style: italic">...</span>
<span style="color: #000; font-style: italic">+++ exited (status 0) +++</span>
<span style="color: #8F5902">% </span><span style="color: #204A87">time</span><span style="color: #F8F8F8">     </span>seconds<span style="color: #F8F8F8">  </span>usecs/call<span style="color: #F8F8F8">     </span>calls<span style="color: #F8F8F8">      </span><span style="color: #204A87; font-weight: bold">function</span>
<span style="color: #000; font-style: italic">------ ----------- ----------- --------- --------------------</span>
<span style="color: #000; font-style: italic"> 21.05    0.000080          2        40 strlen</span>
<span style="color: #000; font-style: italic"> 15.79    0.000060          2        30 __ctype_b_loc</span>
<span style="color: #000; font-style: italic"> 10.53    0.000040          2        20 readdir64</span>
</pre></div>
<h3><strong>-o, --output=FILE</strong></h3>
<p>Write the trace output to FILE instead of stderr.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>ltrace<span style="color: #F8F8F8"> </span>-o<span style="color: #F8F8F8"> </span>trace.log<span style="color: #F8F8F8"> </span>ls
<span style="color: #8F5902">$ </span>cat<span style="color: #F8F8F8"> </span>trace.log
<span style="color: #000; font-style: italic">ls-&gt;__libc_start_main(0x401670, 1, 0x7ffd2d121768, 0x4017a0 &lt;unfinished ...&gt;</span>
<span style="color: #000; font-style: italic">ls-&gt;setlocale(6, &quot;&quot;)                                    = &quot;en_US.UTF-8&quot;</span>
<span style="color: #000; font-style: italic">ls-&gt;bindtextdomain(&quot;coreutils&quot;, &quot;/usr/share/locale&quot;)    = &quot;/usr/share/locale&quot;</span>
</pre></div>
<h2>Usage Examples</h2>
<h3>Basic Usage</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>ltrace<span style="color: #F8F8F8"> </span>ls
<span style="color: #000; font-style: italic">ls-&gt;__libc_start_main(0x401670, 1, 0x7ffd2d121768, 0x4017a0 &lt;unfinished ...&gt;</span>
<span style="color: #000; font-style: italic">ls-&gt;setlocale(6, &quot;&quot;)                                    = &quot;en_US.UTF-8&quot;</span>
<span style="color: #000; font-style: italic">ls-&gt;bindtextdomain(&quot;coreutils&quot;, &quot;/usr/share/locale&quot;)    = &quot;/usr/share/locale&quot;</span>
<span style="color: #000; font-style: italic">ls-&gt;textdomain(&quot;coreutils&quot;)                             = &quot;coreutils&quot;</span>
<span style="color: #000; font-style: italic">ls-&gt;__cxa_atexit(0x4014a0, 0, 0, 0x736c6974)            = 0</span>
<span style="color: #000; font-style: italic">ls-&gt;getenv(&quot;QUOTING_STYLE&quot;)                             = nil</span>
<span style="color: #000; font-style: italic">...</span>
<span style="color: #000; font-style: italic">+++ exited (status 0) +++</span>
</pre></div>
<h3>Tracing Specific Library Calls</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>ltrace<span style="color: #F8F8F8"> </span>-e<span style="color: #F8F8F8"> </span>malloc+free+open<span style="color: #F8F8F8"> </span>./program
<span style="color: #000; font-style: italic">./program-&gt;malloc(1024)                                 = 0x55d7e9fa7260</span>
<span style="color: #000; font-style: italic">./program-&gt;open(&quot;/etc/passwd&quot;, 0, 0)                    = 3</span>
<span style="color: #000; font-style: italic">./program-&gt;malloc(2048)                                 = 0x55d7e9fa7660</span>
<span style="color: #000; font-style: italic">./program-&gt;free(0x55d7e9fa7260)                         = &lt;void&gt;</span>
<span style="color: #000; font-style: italic">./program-&gt;free(0x55d7e9fa7660)                         = &lt;void&gt;</span>
</pre></div>
<h3>Tracing with Time Information</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>ltrace<span style="color: #F8F8F8"> </span>-tt<span style="color: #F8F8F8"> </span>./program
<span style="color: #000; font-style: italic">15:30:45.123456 __libc_start_main(0x401670, 1, 0x7ffd2d121768, 0x4017a0 &lt;unfinished ...&gt;</span>
<span style="color: #000; font-style: italic">15:30:45.123789 setlocale(6, &quot;&quot;)                        = &quot;en_US.UTF-8&quot;</span>
<span style="color: #000; font-style: italic">15:30:45.124012 malloc(1024)                            = 0x55d7e9fa7260</span>
<span style="color: #000; font-style: italic">15:30:45.124234 free(0x55d7e9fa7260)                    = &lt;void&gt;</span>
</pre></div>
<h2>Tips</h2>
<h3>Filter Out Noise</h3>
<p>Use the <code>-e</code> option to focus on specific function calls you're interested in. This helps reduce the output volume and makes analysis easier.</p>
<h3>Combine with strace</h3>
<p>For comprehensive debugging, use both <code>ltrace</code> for library calls and <code>strace</code> for system calls. This provides a complete picture of program behavior.</p>
<h3>Redirect Output for Analysis</h3>
<p>For complex programs, redirect output to a file with <code>-o</code> and then use tools like <code>grep</code> or <code>awk</code> to analyze the trace data.</p>
<h3>Use with Core Dumps</h3>
<p>When debugging crashes, run the program with <code>ltrace</code> to see which library calls were made before the crash occurred.</p>
<h2>Frequently Asked Questions</h2>
<h4>Q1. What's the difference between ltrace and strace?</h4>
<p>A. <code>ltrace</code> traces library calls (functions in shared libraries like libc), while <code>strace</code> traces system calls (direct kernel interactions). <code>ltrace</code> shows higher-level operations like <code>printf()</code>, while <code>strace</code> shows lower-level operations like <code>write()</code>.</p>
<h4>Q2. Can ltrace slow down the traced program?</h4>
<p>A. Yes, tracing adds significant overhead. Each intercepted call requires context switches, which can slow down the program considerably, especially for programs making many library calls.</p>
<h4>Q3. How do I trace only specific library functions?</h4>
<p>A. Use the <code>-e</code> option with a pattern, for example: <code>ltrace -e malloc+free+fopen ./program</code> to trace only memory allocation and file operations.</p>
<h4>Q4. Can ltrace trace statically linked programs?</h4>
<p>A. No, <code>ltrace</code> primarily works with dynamically linked programs. For statically linked programs, the library calls are compiled into the executable and not made through the dynamic linker.</p>
<h2>References</h2>
<p>https://man7.org/linux/man-pages/man1/ltrace.1.html</p>
<h2>Revisions</h2>
<ul>
<li>2025/05/04 First revision</li>
</ul>


    </main>
  </div>

  <footer>
    <p>
      Copyright © 2025 noman project | <a href="https://github.com/atsuoishimoto/noman">GitHub</a> | MIT License
    </p>
  </footer>

  </body>
</html>