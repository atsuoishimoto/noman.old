# diff コマンド

ファイル間の違いを比較して表示します。

## 概要

`diff` コマンドは2つのファイルを行ごとに比較し、その違いを表示します。テキストファイルの変更点を確認したり、コードの修正箇所を特定したりする際に非常に便利です。デフォルトでは、異なる行を含むブロックと、それらがどのように変更されたかを示します。

## オプション

### **-u（統合形式）**

変更された行の前後にコンテキスト（変更されていない行）も含めて表示します。これにより変更内容を理解しやすくなります。

```console
$ diff -u file1.txt file2.txt
--- file1.txt	2025-04-30 10:00:00.000000000 +0900
+++ file2.txt	2025-04-30 10:05:00.000000000 +0900
@@ -1,3 +1,4 @@
 これは最初の行です。
-これは削除される行です。
+これは変更された行です。
 これは最後の行です。
+これは追加された行です。
```

### **-i（大文字小文字を無視）**

大文字と小文字の違いを無視して比較します。

```console
$ diff -i uppercase.txt lowercase.txt
$ # 大文字小文字のみが異なる場合は何も出力されない
```

### **-r（再帰的に比較）**

ディレクトリを再帰的に比較します。サブディレクトリ内のファイルも含めて比較します。

```console
$ diff -r dir1 dir2
diff -r dir1/file.txt dir2/file.txt
2c2
< これは dir1 のファイルです。
---
> これは dir2 のファイルです。
```

### **-y（並列表示）**

2つのファイルを並べて表示し、違いを視覚的に確認しやすくします。

```console
$ diff -y file1.txt file2.txt
これは最初の行です。                  これは最初の行です。
これは削除される行です。             | これは変更された行です。
これは最後の行です。                  これは最後の行です。
                                    > これは追加された行です。
```

## 使用例

### 基本的な比較

```console
$ cat file1.txt
Hello
World
$ cat file2.txt
Hello
Beautiful
World
$ diff file1.txt file2.txt
1a2
> Beautiful
```

### 変更内容をパッチファイルとして保存

```console
$ diff -u original.txt modified.txt > changes.patch
$ # 変更内容がパッチファイルとして保存される
```

### ディレクトリの比較

```console
$ diff -r project_v1 project_v2
# 2つのプロジェクトディレクトリ間の違いが表示される
```

## ヒント:

### 出力の読み方

`diff`の基本出力では、`<`は最初のファイルの行、`>`は2番目のファイルの行を示します。`a`（追加）、`c`（変更）、`d`（削除）の記号は変更の種類を表します。

### パッチの適用

`diff -u`で作成したパッチファイルは、`patch`コマンドで適用できます：
```console
$ patch original.txt < changes.patch
```

### 色付き出力

多くのシステムでは、`diff --color`を使用すると変更箇所が色分けされて表示されます。

### バイナリファイルの比較

テキストファイル以外を比較する場合は、`cmp`コマンドや`hexdump`と組み合わせた方法を検討してください。

## よくある質問

#### Q1. `diff`と`git diff`の違いは何ですか？
A. `diff`は基本的なファイル比較ツールで、`git diff`はGitリポジトリ内の変更を表示するためのGit固有のコマンドです。`git diff`はGitの追跡情報を利用して、より詳細な変更履歴を提供します。

#### Q2. 大きなファイルを比較する場合、パフォーマンスの問題はありますか？
A. はい、非常に大きなファイルを比較する場合、`diff`は遅くなることがあります。そのような場合は、`comm`や`cmp`などの代替コマンドを検討するか、ファイルを分割して比較することをお勧めします。

#### Q3. バイナリファイルを比較できますか？
A. `diff`は主にテキストファイル用に設計されています。バイナリファイルを比較するには、`cmp`や`hexdump`と組み合わせた方法、または専用のバイナリ比較ツールを使用することをお勧めします。

#### Q4. 3つ以上のファイルを比較できますか？
A. 標準の`diff`は2つのファイルのみを比較します。3つ以上のファイルを比較するには、`diff3`コマンドや、より高度な比較ツール（例：`meld`、`kdiff3`）を使用してください。

## macOSでの注意点

macOSの`diff`はGNU版と若干の違いがあります。特に`--color`オプションがない場合があります。カラー出力が必要な場合は、Homebrewで`colordiff`をインストールするか、GNU版の`diff`（`gdiff`）をインストールすることを検討してください。

## 参考情報

https://www.gnu.org/software/diffutils/manual/html_node/diff.html

## 改訂履歴

- 2025/04/30 初版作成