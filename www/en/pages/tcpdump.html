<!DOCTYPE html>
<html lang="en">
  <head>
    
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      
        <link rel="stylesheet" href="/css/reset.css" />
        <link rel="stylesheet" href="/css/main.css" />
        <link rel="stylesheet" href="/css/search.css" />
      

      
        <script src="/en/summary.js"></script>
        <script src="/js/search.js"></script>
        <script src="/js/language-switcher.js"></script>
      
      <title>
        
  tcpdump - noman

      </title>

      

      
    
  </head>
  <body>
    
  <nav>
    <div class="nav-logo">
      <a href="/"><img src="../../../images/white.png" height="50px" /></a>
    </div>
    <div class="nav-right">
      <div class="nav-search">
        <input id="nav-searchbox" type="text" placeholder="Search command..." />
      </div>
      <div class="nav-links">
        <a href="/en/commandlist.html">Commands</a>
        <span id="language-switcher"></span>
      </div>
    </div>
  </nav>

  <div class="content">
    <main>
      
  <h1>tcpdump command</h1>
<p>Capture and analyze network traffic on a system.</p>
<h2>Overview</h2>
<p><code>tcpdump</code> is a powerful command-line packet analyzer that allows you to capture and display network packets being transmitted or received over a network interface. It's commonly used for network troubleshooting, security analysis, and monitoring network activity. The tool can filter packets based on various criteria and display the packet contents in different formats.</p>
<h2>Options</h2>
<h3><strong>-i interface</strong></h3>
<p>Specify the network interface to capture packets from</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>eth0
<span style="color: #000; font-style: italic">tcpdump: verbose output suppressed, use -v or -vv for full protocol decode</span>
<span style="color: #000; font-style: italic">listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</span>
<span style="color: #000; font-style: italic">13:45:22.357928 IP host1.ssh &gt; host2.52986: Flags [P.], seq 196:392, ack 1, win 501, options [nop,nop,TS val 1089067 ecr 1089067], length 196</span>
</pre></div>
<h3><strong>-n</strong></h3>
<p>Don't convert addresses (like host addresses, port numbers, etc.) to names</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-n
<span style="color: #000; font-style: italic">tcpdump: verbose output suppressed, use -v or -vv for full protocol decode</span>
<span style="color: #000; font-style: italic">listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</span>
<span style="color: #000; font-style: italic">13:46:15.123456 IP 192.168.1.100.22 &gt; 192.168.1.101.52986: Flags [P.], seq 196:392, ack 1, win 501, length 196</span>
</pre></div>
<h3><strong>-c count</strong></h3>
<p>Exit after capturing count packets</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-c<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">5</span>
<span style="color: #000; font-style: italic">tcpdump: verbose output suppressed, use -v or -vv for full protocol decode</span>
<span style="color: #000; font-style: italic">listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</span>
<span style="color: #000; font-style: italic">13:47:01.123456 IP host1.ssh &gt; host2.52986: Flags [P.], seq 196:392, ack 1, win 501, length 196</span>
<span style="color: #000; font-style: italic">13:47:01.234567 IP host2.52986 &gt; host1.ssh: Flags [.], ack 392, win 501, length 0</span>
<span style="color: #000; font-style: italic">13:47:01.345678 IP host1.ssh &gt; host2.52986: Flags [P.], seq 392:588, ack 1, win 501, length 196</span>
<span style="color: #000; font-style: italic">13:47:01.456789 IP host2.52986 &gt; host1.ssh: Flags [.], ack 588, win 501, length 0</span>
<span style="color: #000; font-style: italic">13:47:01.567890 IP host1.ssh &gt; host2.52986: Flags [P.], seq 588:784, ack 1, win 501, length 196</span>
<span style="color: #000; font-style: italic">5 packets captured</span>
<span style="color: #000; font-style: italic">10 packets received by filter</span>
<span style="color: #000; font-style: italic">0 packets dropped by kernel</span>
</pre></div>
<h3><strong>-w file</strong></h3>
<p>Write the raw packets to a file instead of parsing and printing them</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-w<span style="color: #F8F8F8"> </span>capture.pcap
<span style="color: #000; font-style: italic">tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</span>
<span style="color: #000; font-style: italic">^C</span>
<span style="color: #000; font-style: italic">45 packets captured</span>
<span style="color: #000; font-style: italic">50 packets received by filter</span>
<span style="color: #000; font-style: italic">0 packets dropped by kernel</span>
</pre></div>
<h3><strong>-r file</strong></h3>
<p>Read packets from a file (previously created with -w)</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-r<span style="color: #F8F8F8"> </span>capture.pcap
<span style="color: #000; font-style: italic">reading from file capture.pcap, link-type EN10MB (Ethernet)</span>
<span style="color: #000; font-style: italic">13:50:01.123456 IP host1.ssh &gt; host2.52986: Flags [P.], seq 196:392, ack 1, win 501, length 196</span>
<span style="color: #000; font-style: italic">13:50:01.234567 IP host2.52986 &gt; host1.ssh: Flags [.], ack 392, win 501, length 0</span>
</pre></div>
<h3><strong>-v, -vv, -vvv</strong></h3>
<p>Increase verbosity level (more packet information)</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-vv
<span style="color: #000; font-style: italic">tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</span>
<span style="color: #000; font-style: italic">13:51:22.357928 IP (tos 0x10, ttl 64, id 12345, offset 0, flags [DF], proto TCP (6), length 240) host1.ssh &gt; host2.52986: Flags [P.], cksum 0x1234 (correct), seq 196:392, ack 1, win 501, options [nop,nop,TS val 1089067 ecr 1089067], length 196</span>
</pre></div>
<h2>Usage Examples</h2>
<h3>Capturing TCP traffic on port 80 (HTTP)</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>eth0<span style="color: #F8F8F8"> </span>tcp<span style="color: #F8F8F8"> </span>port<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">80</span>
<span style="color: #000; font-style: italic">tcpdump: verbose output suppressed, use -v or -vv for full protocol decode</span>
<span style="color: #000; font-style: italic">listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</span>
<span style="color: #000; font-style: italic">13:55:01.123456 IP host1.52986 &gt; webserver.http: Flags [S], seq 123456789, win 64240, options [mss 1460,sackOK,TS val 1089067 ecr 0,nop,wscale 7], length 0</span>
<span style="color: #000; font-style: italic">13:55:01.234567 IP webserver.http &gt; host1.52986: Flags [S.], seq 987654321, ack 123456790, win 65535, options [mss 1460,sackOK,TS val 1089067 ecr 1089067,nop,wscale 7], length 0</span>
</pre></div>
<h3>Capturing traffic from a specific host</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>eth0<span style="color: #F8F8F8"> </span>host<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">192</span>.168.1.100
<span style="color: #000; font-style: italic">tcpdump: verbose output suppressed, use -v or -vv for full protocol decode</span>
<span style="color: #000; font-style: italic">listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</span>
<span style="color: #000; font-style: italic">13:56:01.123456 IP 192.168.1.100.22 &gt; 192.168.1.101.52986: Flags [P.], seq 196:392, ack 1, win 501, length 196</span>
<span style="color: #000; font-style: italic">13:56:01.234567 IP 192.168.1.101.52986 &gt; 192.168.1.100.22: Flags [.], ack 392, win 501, length 0</span>
</pre></div>
<h3>Capturing and saving packets with timestamps</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>eth0<span style="color: #F8F8F8"> </span>-w<span style="color: #F8F8F8"> </span>capture_<span style="color: #204A87; font-weight: bold">$(</span>date<span style="color: #F8F8F8"> </span>+%Y%m%d_%H%M%S<span style="color: #204A87; font-weight: bold">)</span>.pcap
<span style="color: #000; font-style: italic">tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes</span>
<span style="color: #000; font-style: italic">^C</span>
<span style="color: #000; font-style: italic">120 packets captured</span>
<span style="color: #000; font-style: italic">125 packets received by filter</span>
<span style="color: #000; font-style: italic">0 packets dropped by kernel</span>
</pre></div>
<h2>Tips</h2>
<h3>Run with Elevated Privileges</h3>
<p>Most systems require root or administrator privileges to capture packets. Use <code>sudo tcpdump</code> to ensure you have the necessary permissions.</p>
<h3>Use Expressions to Filter Traffic</h3>
<p>Combine expressions with <code>and</code>, <code>or</code>, and <code>not</code> to create complex filters:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>eth0<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;tcp port 80 and not host 192.168.1.5&#39;</span>
</pre></div>
<h3>Limit Packet Capture Size</h3>
<p>Use <code>-s snaplen</code> to limit the number of bytes captured per packet. For headers only, use <code>-s 96</code>:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>eth0<span style="color: #F8F8F8"> </span>-s<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">96</span><span style="color: #F8F8F8"> </span>-c<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">100</span>
</pre></div>
<h3>Disable Name Resolution for Faster Output</h3>
<p>Use <code>-n</code> to disable hostname resolution and <code>-nn</code> to disable both hostname and port name resolution, which makes tcpdump run faster:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>tcpdump<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>eth0<span style="color: #F8F8F8"> </span>-nn
</pre></div>
<h2>Frequently Asked Questions</h2>
<h4>Q1. How do I capture packets on all interfaces?</h4>
<p>A. Use <code>tcpdump -i any</code> to capture on all interfaces.</p>
<h4>Q2. How can I see the packet contents in ASCII?</h4>
<p>A. Use the <code>-A</code> flag to print each packet in ASCII, or <code>-X</code> for both hex and ASCII output.</p>
<h4>Q3. How do I save captured packets to analyze later?</h4>
<p>A. Use <code>tcpdump -w filename.pcap</code> to save raw packets, then analyze with <code>tcpdump -r filename.pcap</code> or tools like Wireshark.</p>
<h4>Q4. How can I filter packets by IP address?</h4>
<p>A. Use <code>tcpdump host 192.168.1.100</code> to capture traffic to/from that IP, or <code>src host</code> or <code>dst host</code> to specify direction.</p>
<h4>Q5. How do I capture only TCP SYN packets?</h4>
<p>A. Use <code>tcpdump 'tcp[tcpflags] &amp; (tcp-syn) != 0'</code> to capture TCP SYN packets.</p>
<h2>References</h2>
<p>https://www.tcpdump.org/manpages/tcpdump.1.html</p>
<h2>Revisions</h2>
<ul>
<li>2025/05/04 First revision</li>
</ul>


    </main>
  </div>

  <footer>
    <p>
      Copyright © 2025 noman project | <a href="https://github.com/atsuoishimoto/noman">GitHub</a> | MIT License
    </p>
  </footer>

  </body>
</html>