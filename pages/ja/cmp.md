# cmp コマンド

ファイルを比較し、最初に異なるバイトを見つけます。

## 概要

`cmp` コマンドは2つのファイルを比較し、内容が異なる最初の位置を報告します。デフォルトでは、ファイルが異なる場合、最初に違いが見つかった場所のバイト位置と行番号を表示します。ファイルが同一の場合は何も出力せず、終了ステータスのみで結果を示します。テキストファイルとバイナリファイルの両方を比較できます。

## オプション

### **-b, --print-bytes**

異なるバイトの値を8進数で表示します。

```console
$ cmp -b file1.txt file2.txt
file1.txt file2.txt は 7 バイト目、1 行目で異なります: 141 101
```

### **-i, --ignore-initial=SKIP**

比較を開始する前に、両方のファイルの先頭からSKIPバイトをスキップします。

```console
$ cmp -i 10 file1.txt file2.txt
file1.txt file2.txt は 15 バイト目、1 行目で異なります
```

### **-l, --verbose**

すべての違いのバイト位置と値を表示します。

```console
$ cmp -l file1.txt file2.txt
7 141 101
10 143 103
15 150 110
```

### **-s, --silent, --quiet**

出力を抑制し、終了ステータスのみを返します。スクリプト内での使用に適しています。

```console
$ cmp -s file1.txt file2.txt
$ echo $?
1  # ファイルが異なる場合は1、同じ場合は0
```

## 使用例

### 基本的な比較

```console
$ cmp file1.txt file2.txt
file1.txt file2.txt は 7 バイト目、1 行目で異なります
```

### スクリプト内での使用

```console
$ if cmp -s file1.txt file2.txt; then
>   echo "ファイルは同一です"
> else
>   echo "ファイルは異なります"
> fi
ファイルは異なります
```

### 標準入力との比較

```console
$ cat file1.txt | cmp - file2.txt
/dev/stdin file2.txt は 7 バイト目、1 行目で異なります
```

## ヒント:

### `diff` との違い

`cmp` は最初の違いだけを報告するのに対し、`diff` はすべての違いを詳細に表示します。バイナリファイルの比較や、ファイルが同一かどうかだけを確認したい場合は `cmp` が適しています。

### 大きなファイルの比較

大きなファイルを比較する場合、`cmp` は `diff` よりも効率的です。最初の違いを見つけた時点で処理を終了するためです。

### 終了ステータス

`cmp` の終了ステータスは以下の通りです：
- 0: ファイルは同一
- 1: ファイルは異なる
- 2: アクセスできないファイルがある

## よくある質問

#### Q1. `cmp` と `diff` はどう使い分ければよいですか？
A. ファイルが同一かどうかだけを確認したい場合や、バイナリファイルを比較する場合は `cmp` を使用します。テキストファイルの違いを詳細に知りたい場合は `diff` を使用します。

#### Q2. `cmp` はディレクトリを比較できますか？
A. いいえ、`cmp` はファイルのみを比較します。ディレクトリを比較するには `diff -r` を使用してください。

#### Q3. 大きなファイルの一部だけを比較するにはどうすればよいですか？
A. `-i` オプションと組み合わせて比較する範囲を指定できます。例えば `cmp -i 1000 -n 500 file1 file2` は1000バイト目から500バイト分だけを比較します。

#### Q4. バイナリファイルの比較結果を読みやすくするには？
A. `-l` オプションを使用すると、すべての違いのバイト位置と値を表示します。さらに詳細な分析には `hexdump` や `xxd` などのツールと組み合わせると効果的です。

## 参考文献

https://www.gnu.org/software/diffutils/manual/html_node/Invoking-cmp.html

## 改訂履歴

- 2025/04/30 初版作成