# awk コマンド概要

`awk` はテキスト処理のためのプログラミング言語であり、パターンマッチングとテキスト操作に特化したコマンドです。ファイルやパイプからのデータを行単位で処理し、フィールド（列）ごとに操作できます。

## オプション

### **-F** (フィールド区切り文字の指定)

デフォルトの区切り文字（空白）以外を使用したい場合に指定します。

```bash
$ echo "apple,orange,banana" | awk -F, '{print $2}'
orange
```

### **-v** (変数の定義)

awk プログラム内で使用する変数を事前に定義します。

```bash
$ awk -v name="Taro" '{print "Hello, " name "! This is line " NR}' sample.txt
Hello, Taro! This is line 1
Hello, Taro! This is line 2
```

### **-f** (プログラムファイルの指定)

awk プログラムを別ファイルから読み込みます。

```bash
$ cat program.awk
{print $1, $3}
$ awk -f program.awk data.txt
名前 年齢
田中 25
佐藤 30
```

## 使用例

### 基本的な列の抽出

```bash
$ cat data.txt
名前 性別 年齢 職業
田中 男性 25 エンジニア
佐藤 女性 30 デザイナー
鈴木 男性 45 マネージャー

$ awk '{print $1, $3}' data.txt
名前 年齢
田中 25
佐藤 30
鈴木 45
```

### 条件付き処理

```bash
$ awk '$3 > 30 {print $1 "さんは" $3 "歳です"}' data.txt
鈴木さんは45歳です
```

### 計算処理

```bash
$ cat numbers.txt
10 20
30 40
50 60

$ awk '{sum = $1 + $2; print "合計: " sum}' numbers.txt
合計: 30
合計: 70
合計: 110
```

### BEGIN と END ブロック

```bash
$ awk 'BEGIN {print "処理開始"} {sum += $3} END {print "平均年齢: " sum/NR "歳"}' data.txt
処理開始
平均年齢: 33.3333歳
```

## よくある質問

### Q1. awk の基本的な構文は？
A. 基本構文は `awk 'パターン {アクション}' ファイル名` です。パターンに一致する行に対してアクションが実行されます。

### Q2. awk の組み込み変数にはどのようなものがありますか？
A. 主な組み込み変数には、`NR`（現在の行番号）、`NF`（現在の行のフィールド数）、`FS`（フィールド区切り文字）、`OFS`（出力フィールド区切り文字）などがあります。

### Q3. awk で複数の条件を指定するには？
A. 論理演算子（`&&`、`||`、`!`）を使用して複数の条件を組み合わせることができます。例：`awk '$3 > 30 && $2 == "男性" {print $1}' data.txt`

### Q4. awk と sed の違いは何ですか？
A. `sed` は主に文字列置換に特化していますが、`awk` はより高度なテキスト処理（計算、条件分岐など）ができるプログラミング言語です。

## 追加のヒント

- `awk` はシングルクォート（`'`）で囲むことが重要です。シェル変数を使用する場合は注意が必要です。
- 複雑な処理は別ファイルに記述して `-f` オプションで読み込むと管理しやすくなります。
- `awk` は正規表現をサポートしており、`/パターン/` の形式で使用できます。例：`awk '/エンジニア/ {print $1}'`
- 大きなファイルを処理する場合、`awk` は各行を読み込んで処理するため、メモリ効率が良いです。