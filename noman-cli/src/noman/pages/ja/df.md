# df コマンド

マウントされたファイルシステムのディスク容量使用状況を表示します。

## 概要

`df`コマンドは、ファイルシステム上の使用済みおよび利用可能なディスク容量を報告します。デフォルトでは1Kブロック単位で表示しますが、人間が読みやすい形式で表示するように設定することもできます。ディスク使用量を監視し、容量が不足しているファイルシステムを特定するために一般的に使用されます。

## オプション

### **-h, --human-readable**

サイズを人間が読みやすい形式で表示します（例：1K、234M、2G）

```console
$ df -h
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda1        20G  7.8G   11G  42% /
tmpfs           3.9G     0  3.9G   0% /dev/shm
/dev/sda3       450G  254G  174G  60% /home
```

### **-T, --print-type**

ファイルシステムの種類を表示します（例：ext4、xfs）

```console
$ df -T
Filesystem     Type     1K-blocks     Used Available Use% Mounted on
/dev/sda1      ext4      20971520  8126464  11714048  42% /
tmpfs          tmpfs      4048380        0   4048380   0% /dev/shm
/dev/sda3      ext4     471859200 266338304 181889024  60% /home
```

### **-i, --inodes**

ブロック使用量の代わりにiノード情報を表示します

```console
$ df -i
Filesystem      Inodes  IUsed    IFree IUse% Mounted on
/dev/sda1      1310720 248932  1061788   19% /
tmpfs          1012095      1  1012094    1% /dev/shm
/dev/sda3      29491200 845621 28645579    3% /home
```

### **-a, --all**

0ブロックのファイルシステムやデフォルトで無視されるファイルシステムも含めて表示します

```console
$ df -a
Filesystem     1K-blocks     Used Available Use% Mounted on
/dev/sda1       20971520  8126464  11714048  42% /
proc                   0        0         0    - /proc
sysfs                  0        0         0    - /sys
tmpfs            4048380        0   4048380   0% /dev/shm
/dev/sda3      471859200 266338304 181889024  60% /home
```

## 使用例

### 特定のファイルシステムの容量確認

```console
$ df -h /home
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda3       450G  254G  174G  60% /home
```

### オプションを組み合わせた詳細出力

```console
$ df -hT
Filesystem     Type   Size  Used Avail Use% Mounted on
/dev/sda1      ext4    20G  7.8G   11G  42% /
tmpfs          tmpfs  3.9G     0  3.9G   0% /dev/shm
/dev/sda3      ext4   450G  254G  174G  60% /home
```

## ヒント:

### 重要なファイルシステムに焦点を当てる

物理ディスクのみを表示したい場合は、`df -h | grep -v tmpfs`を使用して一時的なファイルシステムを除外できます。

### 重要なファイルシステムを監視する

ファイルシステムが特定の割合を超えたときにアラートを設定します。例えば、ルートが90%以上使用されているかを確認するには：`df -h / | awk 'NR==2 {print $5}' | sed 's/%//'`を使用します。

### iノード使用量を確認する

特に小さなファイルが多数ある場合、ファイルシステムは容量が不足する前にiノードが不足することがあります。`df -i`を使用してiノード使用量を監視しましょう。

## よくある質問

#### Q1. df出力の「Use%」とは何ですか？
A. 現在使用中のファイルシステムの割合を示しています。値が100%に近づくと、ファイルシステムがほぼ満杯であることを示します。

#### Q2. なぜdfは予想よりも少ない空き容量を表示するのですか？
A. デフォルトでは、ほとんどのファイルシステムはroot用とシステムプロセス用に5%の容量を予約しています。この予約容量は一般ユーザーが利用可能な容量としてカウントされません。

#### Q3. キロバイトではなくギガバイト単位でディスク使用量を確認するにはどうすればよいですか？
A. `df -h`を使用すると、適切な単位（KB、MB、GBなど）に自動的に調整される人間が読みやすい出力が表示されます。

#### Q4. 一部のファイルシステムが0ブロックまたは100%使用と表示されるのはなぜですか？
A. /procや/sysのような仮想ファイルシステムは実際のディスク容量を使用しないため、0ブロックと表示されます。これらはメモリ上にのみ存在します。

## macOSに関する注意点

macOSでは、`df`コマンドのオプションが若干異なります。`-T`オプションは利用できず、出力形式も異なります。人間が読みやすい出力には`df -h`を使用してください。これはプラットフォーム間で一貫して動作します。

## 参考資料

https://www.gnu.org/software/coreutils/manual/html_node/df-invocation.html

## 改訂履歴

- 2025/05/04 初回改訂