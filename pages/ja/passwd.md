# passwd コマンド

ユーザーアカウントのパスワードを変更します。

## 概要

`passwd` コマンドは、ユーザーアカウントのパスワードを変更するために使用されます。引数なしで実行すると、現在ログインしているユーザーのパスワードを変更します。root ユーザーは、システム上の任意のユーザーのパスワードを変更することができます。

## オプション

### **-d**

ユーザーのパスワードを削除し、パスワードなしのログインを許可します（root 権限が必要）。

```console
$ sudo passwd -d username
passwd: パスワードは正常に削除されました
```

### **-l**

ユーザーアカウントをロックします（root 権限が必要）。

```console
$ sudo passwd -l username
passwd: パスワードは正常に更新されました
passwd: アカウントはロックされています。
```

### **-u**

ロックされたユーザーアカウントのロックを解除します（root 権限が必要）。

```console
$ sudo passwd -u username
passwd: パスワードは正常に更新されました
passwd: アカウントのロックは解除されています。
```

### **-e**

ユーザーに次回ログイン時にパスワードの変更を強制します（root 権限が必要）。

```console
$ sudo passwd -e username
passwd: パスワードは正常に期限切れになりました
```

### **-S**

ユーザーアカウントのパスワードステータスを表示します。

```console
$ passwd -S username
username PS 2025-04-15 0 99999 7 -1
```

## 使用例

### 自分のパスワードを変更する

```console
$ passwd
現在のパスワード: 
新しいパスワード: 
新しいパスワードを再入力してください: 
passwd: パスワードは正常に更新されました
```

### 他のユーザーのパスワードを変更する（root権限が必要）

```console
$ sudo passwd username
新しいパスワード: 
新しいパスワードを再入力してください: 
passwd: パスワードは正常に更新されました
```

### パスワードステータスの確認

```console
$ sudo passwd -S username
username PS 2025-04-30 0 99999 7 -1
```

出力の意味: ユーザー名、パスワードステータス（PS=設定済み）、最終変更日、最小有効期間（日）、最大有効期間（日）、警告期間（日）、非アクティブ期間（日）

## ヒント:

### 強力なパスワードを使用する

セキュリティのために、大文字、小文字、数字、特殊文字を組み合わせた長いパスワードを使用しましょう。多くのシステムでは、弱いパスワードは拒否されます。

### パスワードポリシーの確認

システムによってはパスワードの複雑さや長さに関する要件があります。`/etc/security/pwquality.conf`（または類似のファイル）でパスワードポリシーを確認できます。

### root権限の注意点

root権限でパスワードを変更する場合、現在のパスワードを入力する必要はありません。これは便利ですが、権限を持つユーザーは注意して使用する必要があります。

## よくある質問

#### Q1. パスワードを忘れた場合はどうすればいいですか？
A. 一般ユーザーの場合は、システム管理者（root権限を持つユーザー）に連絡してパスワードをリセットしてもらう必要があります。root パスワードを忘れた場合は、シングルユーザーモードで起動するか、ライブCDから起動して回復する必要があります。

#### Q2. パスワードの最小長はどのくらいですか？
A. システムの設定によって異なりますが、多くのLinuxシステムでは最低8文字以上を推奨しています。実際の最小長は `/etc/login.defs` や `/etc/security/pwquality.conf` で設定されています。

#### Q3. パスワードの有効期限を確認するにはどうすればいいですか？
A. `passwd -S ユーザー名` または `chage -l ユーザー名` コマンドでパスワードの有効期限情報を確認できます。

#### Q4. パスワードなしでユーザーを作成できますか？
A. はい、ユーザーを作成した後、`sudo passwd -d ユーザー名` を実行してパスワードを削除できます。ただし、これはセキュリティリスクとなる可能性があります。

## macOSでの注意点

macOSでは、`passwd` コマンドの動作が若干異なります。多くのオプションはサポートされておらず、主にパスワード変更の基本機能のみが利用可能です。また、macOSではユーザー管理に「システム環境設定」の「ユーザーとグループ」パネルを使用することも一般的です。

## 参考資料

man passwd

## 改訂履歴

- 2025/04/30 初版作成