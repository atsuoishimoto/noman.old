# if コマンド概要

`if` はシェルスクリプトで条件分岐を実行するためのコマンドです。特定の条件が真の場合にのみ、指定されたコマンドを実行します。

## オプション

`if` コマンド自体にはオプションはありませんが、条件式と組み合わせて使用します。

## 基本構文

### **基本的な if 文**

最も基本的な形式です。条件が真の場合のみコマンドを実行します。

```bash
if [ 条件 ]; then
    # 条件が真の場合に実行されるコマンド
fi
```

### **if-else 文**

条件が真の場合と偽の場合で異なるコマンドを実行します。

```bash
if [ 条件 ]; then
    # 条件が真の場合に実行されるコマンド
else
    # 条件が偽の場合に実行されるコマンド
fi
```

### **if-elif-else 文**

複数の条件を順番にチェックします。

```bash
if [ 条件1 ]; then
    # 条件1が真の場合に実行されるコマンド
elif [ 条件2 ]; then
    # 条件1が偽で条件2が真の場合に実行されるコマンド
else
    # すべての条件が偽の場合に実行されるコマンド
fi
```

## 使用例

### 数値比較

```bash
#!/bin/bash
age=25

if [ $age -gt 18 ]; then
    echo "成人です"
else
    echo "未成年です"
fi

# 出力: 成人です
```

### ファイル存在チェック

```bash
#!/bin/bash
if [ -f "config.txt" ]; then
    echo "設定ファイルが存在します"
else
    echo "設定ファイルが見つかりません"
    touch config.txt
    echo "設定ファイルを作成しました"
fi
```

### 文字列比較

```bash
#!/bin/bash
username="admin"

if [ "$username" = "admin" ]; then
    echo "管理者権限でログインしました"
else
    echo "一般ユーザーでログインしました"
fi

# 出力: 管理者権限でログインしました
```

### コマンド実行結果の確認

```bash
#!/bin/bash
if grep "error" log.txt > /dev/null; then
    echo "エラーが見つかりました"
else
    echo "エラーはありません"
fi
```

## よく使われる条件式

### ファイル関連

- `-f ファイル名`: ファイルが存在し、通常のファイルである
- `-d ディレクトリ名`: ディレクトリが存在する
- `-r ファイル名`: ファイルが読み取り可能
- `-w ファイル名`: ファイルが書き込み可能
- `-x ファイル名`: ファイルが実行可能

### 数値比較

- `-eq`: 等しい
- `-ne`: 等しくない
- `-gt`: より大きい
- `-lt`: より小さい
- `-ge`: 以上
- `-le`: 以下

### 文字列比較

- `=` または `==`: 等しい
- `!=`: 等しくない
- `-z 文字列`: 文字列が空
- `-n 文字列`: 文字列が空でない

## よくある質問

### Q1. `if` と `test` コマンドの関係は？
A. `[ 条件 ]` は実際には `test` コマンドの別の書き方です。`if test 条件` と `if [ 条件 ]` は同じ意味になります。

### Q2. `[[ ]]` と `[ ]` の違いは何ですか？
A. `[[ ]]` はBashの拡張機能で、より高度なパターンマッチングや論理演算子（`&&`, `||`）をサポートしています。`[ ]` はPOSIX互換の基本的なテストコマンドです。

### Q3. 複数の条件を組み合わせるにはどうすればいいですか？
A. `-a`（AND）や `-o`（OR）を使用するか、`[[ ]]` を使用して `&&`（AND）や `||`（OR）で条件を組み合わせることができます。

```bash
# [ ] での例
if [ $age -gt 18 -a "$name" = "Taro" ]; then
    echo "条件を満たしています"
fi

# [[ ]] での例（Bashの場合）
if [[ $age -gt 18 && "$name" = "Taro" ]]; then
    echo "条件を満たしています"
fi
```

## 追加のヒント

- 変数を条件式で使用する場合は、変数を引用符（`"$変数"`）で囲むことをお勧めします。これにより、変数が空の場合や空白を含む場合のエラーを防ぐことができます。
- `if` 文の条件部分では、最後に実行されたコマンドの終了ステータスをチェックします。終了ステータスが0（成功）の場合、条件は真と見なされます。
- 複雑な条件分岐が必要な場合は、`case` 文を検討してください。複数の値に対する分岐を簡潔に書くことができます。