# su コマンド

ユーザーを切り替えるコマンドです。

## 概要

`su`（substitute user）コマンドは、現在のセッション内で別のユーザーに切り替えるために使用します。デフォルトでは引数なしで実行すると、rootユーザーに切り替わります。システム管理タスクの実行や、他のユーザーアカウントでのコマンド実行に便利です。

## オプション

### **-**（ハイフン）

ログインシェルとして起動し、ターゲットユーザーの環境変数を読み込みます。

```console
$ su -
Password: （パスワードを入力）
#
```

### **-c "command"**

指定したコマンドを実行した後、元のユーザーに戻ります。

```console
$ su -c "whoami"
Password: （パスワードを入力）
root
```

### **username**

特定のユーザー名を指定して切り替えます。

```console
$ su alice
Password: （パスワードを入力）
$
```

## 使用例

### rootユーザーに切り替える

```console
$ whoami
alice
$ su
Password: （rootのパスワードを入力）
# whoami
root
```

### 別のユーザーに切り替えて環境変数も読み込む

```console
$ su - bob
Password: （bobのパスワードを入力）
$ echo $HOME
/home/bob
```

### 一時的に別のユーザーとしてコマンドを実行する

```console
$ su -c "apt update" root
Password: （rootのパスワードを入力）
（aptのアップデート出力）
```

## ヒント:

### rootユーザーへの切り替えには sudo を検討する

多くの現代的なLinuxディストリビューションでは、`sudo`コマンドを使用してrootユーザー権限でコマンドを実行する方が推奨されています。`sudo`は各コマンドの実行ログを残すため、セキュリティ上より安全です。

### 環境変数の引き継ぎに注意

単に`su username`とすると、現在のユーザーの環境変数が引き継がれます。完全に対象ユーザーの環境で作業するには`su - username`を使用しましょう。

### 終了方法

ユーザー切り替え後、元のユーザーに戻るには`exit`コマンドまたは`Ctrl+D`を使用します。

## よくある質問

#### Q1. `su`と`sudo`の違いは何ですか？
A. `su`はユーザーを完全に切り替えるのに対し、`sudo`は一時的に特権コマンドを実行するためのものです。`sudo`はより詳細なアクセス制御が可能で、パスワードの入力頻度も設定できます。

#### Q2. `su -`と`su`の違いは何ですか？
A. `su -`はログインシェルとして起動し、対象ユーザーの環境変数や設定を読み込みます。一方、`su`だけではユーザーIDは変わりますが、現在の環境変数が維持されます。

#### Q3. rootパスワードがわからない場合はどうすればいいですか？
A. 多くのLinuxディストリビューションでは、インストール時にrootパスワードを設定していない場合があります。その場合は`sudo su`を使用してrootになれることがあります。

## macOSでの注意点

macOSでは`su`コマンドの動作が異なります。デフォルトではrootアカウントは無効化されており、管理者権限が必要な操作には`sudo`コマンドを使用するのが一般的です。macOSで`su`を使用するには、まず`sudo su`を実行するか、事前に`sudo passwd root`でrootパスワードを設定する必要があります。

## 参考文献

https://man7.org/linux/man-pages/man1/su.1.html

## 改訂履歴

- 2025/04/30 初版作成