# chsh コマンド

ユーザーのログインシェルを変更します。

## 概要

`chsh`（change shell）コマンドは、ユーザーのログインシェルを変更するためのコマンドです。ログインシェルとは、ユーザーがログインした際に自動的に起動されるシェルプログラムのことです。このコマンドを使用することで、bash、zsh、fishなど、システムにインストールされている別のシェルに切り替えることができます。

## オプション

### **-s, --shell**

新しいログインシェルを指定します。

```console
$ chsh -s /bin/zsh
パスワード: 
シェルを変更しました。
```

### **-l, --list-shells**

システムで利用可能なシェルの一覧を表示します。

```console
$ chsh -l
/bin/bash
/bin/dash
/bin/zsh
/usr/bin/fish
```

## 使用例

### 自分のログインシェルを変更する

```console
$ chsh -s /bin/zsh
パスワード: 
シェルを変更しました。
```

### 他のユーザーのシェルを変更する（rootユーザーのみ）

```console
$ sudo chsh -s /bin/bash username
```

### 現在のシェルを確認する

```console
$ echo $SHELL
/bin/bash
```

## ヒント:

### システムに登録されているシェルのみ使用可能

`chsh`コマンドでは、`/etc/shells`ファイルに登録されているシェルのみ使用できます。カスタムシェルを使用したい場合は、まずこのファイルに追加する必要があります。

### 変更の反映

シェルの変更はログアウトして再ログインした後に反映されます。現在のセッションには影響しません。

### シェルのパスを正確に指定する

シェルを変更する際は、シェルの完全なパス（例：`/bin/zsh`）を指定する必要があります。シェル名だけ（例：`zsh`）では動作しません。

## よくある質問

#### Q1. シェルを変更した後、変更を反映するにはどうすればよいですか？
A. ログアウトして再ログインすると、新しいシェルが使用されます。

#### Q2. 利用可能なシェルの一覧はどこで確認できますか？
A. `chsh -l`コマンドを実行するか、`/etc/shells`ファイルの内容を確認してください。

#### Q3. シェル変更に失敗する場合はどうすればよいですか？
A. 指定したシェルが`/etc/shells`に登録されていることを確認してください。また、正しいパスワードを入力していることも確認してください。

#### Q4. 元のシェルに戻すにはどうすればよいですか？
A. 同じ`chsh`コマンドを使用して、元のシェルのパスを指定します（例：`chsh -s /bin/bash`）。

## macOSでの注意点

macOSでは、システム環境設定の「ユーザとグループ」からもログインシェルを変更できます。また、macOSのデフォルトシェルはzshになっています（Catalina以降）。Homebrewでインストールしたシェルを使用する場合は、そのパスを`/etc/shells`に追加する必要があります。

## 参考文献

https://linux.die.net/man/1/chsh

## 改訂履歴

- 2025/04/30 初版作成