<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../../css/reset.css">
  <link rel="stylesheet" href="../../css/main.css">
  <link rel="stylesheet" href="../../css/main-ja.css">
  <link rel="stylesheet" href="../../css/search.css">
  <script src="../../js/search.js"></script>
  <title>{{ command }} - noman</title>
</head>
<body>

  <!-- ナビゲーションバー -->
  <nav>
    <div class="nav-logo"><img src="../../../images/white.png" height="50px"></div>
    <div class="nav-right">
      <div class="nav-links">
        <a href="#">Docs</a>
        <a href="#">Try</a>
        <a href="#">GitHub</a>
      </div>
      <div class="nav-search">
        <input id="nav-searchbox" type="text" placeholder="Search command...">
      </div>
    </div>
  </nav>

  <div class="content">

  <main>


<h1>getopt</h1>
<p><code>getopt</code>は、コマンドラインオプションを解析するためのユーティリティです。シェルスクリプト内でコマンドライン引数を標準化された方法で処理するのに役立ちます。</p>
<h2>オプション</h2>
<h3><strong>-o, --options</strong></h3>
<p>短いオプション（一文字）を指定します。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>getopt<span style="color: #F8F8F8"> </span>-o<span style="color: #F8F8F8"> </span>a:bc<span style="color: #F8F8F8"> </span>file1<span style="color: #F8F8F8"> </span>file2
<span style="color: #F8F8F8"> </span>-a<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;file1&#39;</span><span style="color: #F8F8F8"> </span>-b<span style="color: #F8F8F8"> </span>-c<span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;file2&#39;</span>
</pre></div>
<h3><strong>-l, --longoptions</strong></h3>
<p>長いオプション（単語）を指定します。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>getopt<span style="color: #F8F8F8"> </span>-o<span style="color: #F8F8F8"> </span>a:bc<span style="color: #F8F8F8"> </span>-l<span style="color: #F8F8F8"> </span>alpha:,beta,gamma<span style="color: #F8F8F8"> </span>file1<span style="color: #F8F8F8"> </span>file2
<span style="color: #F8F8F8"> </span>-a<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;file1&#39;</span><span style="color: #F8F8F8"> </span>-b<span style="color: #F8F8F8"> </span>-c<span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;file2&#39;</span>
</pre></div>
<h3><strong>-n, --name</strong></h3>
<p>エラーメッセージに表示するプログラム名を指定します。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>getopt<span style="color: #F8F8F8"> </span>-n<span style="color: #F8F8F8"> </span>myscript<span style="color: #F8F8F8"> </span>-o<span style="color: #F8F8F8"> </span>a:bc<span style="color: #F8F8F8"> </span>file1<span style="color: #F8F8F8"> </span>file2
<span style="color: #F8F8F8"> </span>-a<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;file1&#39;</span><span style="color: #F8F8F8"> </span>-b<span style="color: #F8F8F8"> </span>-c<span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;file2&#39;</span>
</pre></div>
<h3><strong>-q, --quiet</strong></h3>
<p>エラーメッセージを抑制します。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>getopt<span style="color: #F8F8F8"> </span>-q<span style="color: #F8F8F8"> </span>-o<span style="color: #F8F8F8"> </span>a:bc<span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span>-x<span style="color: #F8F8F8"> </span>file1
<span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;-x&#39;</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;file1&#39;</span>
</pre></div>
<h3><strong>-u, --unquoted</strong></h3>
<p>出力を引用符で囲まないようにします。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>getopt<span style="color: #F8F8F8"> </span>-u<span style="color: #F8F8F8"> </span>-o<span style="color: #F8F8F8"> </span>a:bc<span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span>-a<span style="color: #F8F8F8"> </span>file1
<span style="color: #F8F8F8"> </span>-a<span style="color: #F8F8F8"> </span>file1<span style="color: #F8F8F8"> </span>--
</pre></div>
<h2>使用例</h2>
<h3>基本的なシェルスクリプトでの使用例</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902; font-style: italic">#!/bin/bash</span>
<span style="color: #8F5902; font-style: italic"># オプションを解析</span>
<span style="color: #000">OPTS</span><span style="color: #CE5C00; font-weight: bold">=</span><span style="color: #204A87; font-weight: bold">$(</span>getopt<span style="color: #F8F8F8"> </span>-o<span style="color: #F8F8F8"> </span>ab:c<span style="color: #F8F8F8"> </span>-l<span style="color: #F8F8F8"> </span>alpha,beta:,gamma<span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;</span><span style="color: #000">$@</span><span style="color: #4E9A06">&quot;</span><span style="color: #204A87; font-weight: bold">)</span>
<span style="color: #204A87">eval</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">set</span><span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;</span><span style="color: #000">$OPTS</span><span style="color: #4E9A06">&quot;</span>

<span style="color: #8F5902; font-style: italic"># オプションを処理</span>
<span style="color: #204A87; font-weight: bold">while</span><span style="color: #F8F8F8"> </span>true<span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87; font-weight: bold">do</span>
<span style="color: #F8F8F8">  </span><span style="color: #204A87; font-weight: bold">case</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;</span><span style="color: #000">$1</span><span style="color: #4E9A06">&quot;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87; font-weight: bold">in</span>
<span style="color: #F8F8F8">    </span>-a<span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>--alpha<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #000">ALPHA</span><span style="color: #CE5C00; font-weight: bold">=</span>true<span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">shift</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">    </span>-b<span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>--beta<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #000">BETA</span><span style="color: #CE5C00; font-weight: bold">=</span><span style="color: #4E9A06">&quot;</span><span style="color: #000">$2</span><span style="color: #4E9A06">&quot;</span><span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">shift</span><span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">2</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">    </span>-c<span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>--gamma<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #000">GAMMA</span><span style="color: #CE5C00; font-weight: bold">=</span>true<span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">shift</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">    </span>--<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span>shift<span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87; font-weight: bold">break</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">    </span>*<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;不明なオプション: </span><span style="color: #000">$1</span><span style="color: #4E9A06">&quot;</span><span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">exit</span><span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">1</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">  </span><span style="color: #204A87; font-weight: bold">esac</span>
<span style="color: #204A87; font-weight: bold">done</span>

<span style="color: #8F5902; font-style: italic"># 残りの引数を処理</span>
<span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;ALPHA=</span><span style="color: #000">$ALPHA</span><span style="color: #4E9A06">&quot;</span>
<span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;BETA=</span><span style="color: #000">$BETA</span><span style="color: #4E9A06">&quot;</span>
<span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;GAMMA=</span><span style="color: #000">$GAMMA</span><span style="color: #4E9A06">&quot;</span>
<span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;残りの引数: </span><span style="color: #000">$@</span><span style="color: #4E9A06">&quot;</span>
</pre></div>
<h3>複雑なオプション処理の例</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902; font-style: italic">#!/bin/bash</span>
<span style="color: #8F5902; font-style: italic"># 値を必要とするオプションと値を必要としないオプションを混在させる</span>
<span style="color: #000">OPTS</span><span style="color: #CE5C00; font-weight: bold">=</span><span style="color: #204A87; font-weight: bold">$(</span>getopt<span style="color: #F8F8F8"> </span>-o<span style="color: #F8F8F8"> </span>a:bc::d<span style="color: #F8F8F8"> </span>-l<span style="color: #F8F8F8"> </span>alpha:,beta,charlie::,delta<span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;</span><span style="color: #000">$@</span><span style="color: #4E9A06">&quot;</span><span style="color: #204A87; font-weight: bold">)</span>
<span style="color: #204A87">eval</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">set</span><span style="color: #F8F8F8"> </span>--<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;</span><span style="color: #000">$OPTS</span><span style="color: #4E9A06">&quot;</span>

<span style="color: #204A87; font-weight: bold">while</span><span style="color: #F8F8F8"> </span>true<span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87; font-weight: bold">do</span>
<span style="color: #F8F8F8">  </span><span style="color: #204A87; font-weight: bold">case</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;</span><span style="color: #000">$1</span><span style="color: #4E9A06">&quot;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87; font-weight: bold">in</span>
<span style="color: #F8F8F8">    </span>-a<span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>--alpha<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;alphaオプション: </span><span style="color: #000">$2</span><span style="color: #4E9A06">&quot;</span><span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">shift</span><span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">2</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">    </span>-b<span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>--beta<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;betaオプションが指定されました&quot;</span><span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">shift</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">    </span>-c<span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>--charlie<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span>
<span style="color: #F8F8F8">      </span><span style="color: #204A87; font-weight: bold">case</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;</span><span style="color: #000">$2</span><span style="color: #4E9A06">&quot;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87; font-weight: bold">in</span>
<span style="color: #F8F8F8">        </span><span style="color: #4E9A06">&quot;&quot;</span><span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;charlieオプション（値なし）&quot;</span><span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">shift</span><span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">2</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">        </span>*<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;charlieオプション: </span><span style="color: #000">$2</span><span style="color: #4E9A06">&quot;</span><span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">shift</span><span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">2</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">      </span><span style="color: #204A87; font-weight: bold">esac</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">    </span>-d<span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>--delta<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;deltaオプションが指定されました&quot;</span><span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">shift</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">    </span>--<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span>shift<span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87; font-weight: bold">break</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">    </span>*<span style="color: #CE5C00; font-weight: bold">)</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;エラー: 不明なオプション: </span><span style="color: #000">$1</span><span style="color: #4E9A06">&quot;</span><span style="color: #000; font-weight: bold">;</span><span style="color: #F8F8F8"> </span><span style="color: #204A87">exit</span><span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">1</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">;;</span>
<span style="color: #F8F8F8">  </span><span style="color: #204A87; font-weight: bold">esac</span>
<span style="color: #204A87; font-weight: bold">done</span>

<span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;残りの引数: </span><span style="color: #000">$@</span><span style="color: #4E9A06">&quot;</span>
</pre></div>
<h2>よくある質問</h2>
<h3>Q1. <code>getopt</code>と<code>getopts</code>の違いは何ですか？</h3>
<p>A. <code>getopt</code>は外部コマンドで、長いオプション（<code>--option</code>形式）をサポートしています。一方、<code>getopts</code>はシェル組み込みコマンドで、短いオプション（<code>-o</code>形式）のみをサポートしますが、より移植性が高いです。</p>
<h3>Q2. オプションが値を取るかどうかを指定するには？</h3>
<p>A. <code>-o</code>オプションで、オプション文字の後に<code>:</code> を付けると値が必要、<code>::</code> を付けると値が任意になります。例：<code>-o a:b::c</code></p>
<h3>Q3. <code>eval set -- &quot;$OPTS&quot;</code>の目的は何ですか？</h3>
<p>A. <code>getopt</code>の出力を<code>eval set</code>することで、元のコマンドライン引数を整形された形式に置き換え、後続の処理を簡単にします。</p>
<h3>Q4. エラー処理はどうすればよいですか？</h3>
<p>A. <code>getopt</code>はオプションが無効な場合にエラーを返します。スクリプトでは通常、<code>getopt</code>の戻り値をチェックし、エラーが発生した場合は処理を中止します。</p>
<h2>追加情報</h2>
<ul>
<li><code>getopt</code>の新しいバージョン（enhanced getopt）と古いバージョンがあり、機能が異なります。Linux では通常、拡張版が使用されます。</li>
<li>macOSのデフォルトの<code>getopt</code>は機能が限られているため、GNU版の<code>getopt</code>をインストールすることをお勧めします（<code>brew install gnu-getopt</code>でインストール可能）。</li>
<li>複雑なオプション処理が必要な場合は、より強力な<code>argparse</code>などのPythonライブラリの使用も検討してください。</li>
<li>オプション指定の標準的な形式は、単一文字オプションには<code>-</code>（例：<code>-a</code>）、単語オプションには<code>--</code>（例：<code>--alpha</code>）を使用します。</li>
</ul>
<h2>参考資料</h2>
<p>https://www.gnu.org/software/libc/manual/html_node/Getopt.html</p>



    
  </main>
  </div>
<footer>
  <div>
    <a href="#">GitHub</a> |
    MIT License
  </div>
</footer>
</body>
</html>
