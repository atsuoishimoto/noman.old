# jqコマンド概要

jqは、JSONデータを処理・操作するための軽量で柔軟なコマンドラインツールです。JSONデータのフィルタリング、変換、整形などを簡単に行うことができます。

## 主なオプション

- **-r, --raw-output**: 出力結果から引用符を取り除きます
  - 例: `jq -r '.name' data.json`

- **-c, --compact-output**: 出力を1行にまとめます（整形なし）
  - 例: `jq -c '.' data.json`

- **-s, --slurp**: 複数のJSONオブジェクトを配列として読み込みます
  - 例: `jq -s '.' file1.json file2.json`

- **-f, --from-file**: ファイルからjqフィルタを読み込みます
  - 例: `jq -f filter.jq data.json`

## 基本的な使い方

### 整形（Pretty Print）
```bash
# 整形されたJSONを表示
echo '{"name":"田中","age":30}' | jq '.'
# 出力結果
{
  "name": "田中",
  "age": 30
}
```

### 特定のフィールドを抽出
```bash
# nameフィールドのみを抽出
echo '{"name":"田中","age":30}' | jq '.name'
# 出力結果
"田中"

# 引用符なしで抽出
echo '{"name":"田中","age":30}' | jq -r '.name'
# 出力結果
田中
```

### 配列の操作
```bash
# 配列の最初の要素を取得
echo '[{"name":"田中"},{"name":"佐藤"}]' | jq '.[0]'
# 出力結果
{
  "name": "田中"
}

# 配列内の全ての要素から特定のフィールドを抽出
echo '[{"name":"田中"},{"name":"佐藤"}]' | jq '.[].name'
# 出力結果
"田中"
"佐藤"
```

### フィルタリング
```bash
# 条件に合う要素のみを抽出
echo '[{"name":"田中","age":25},{"name":"佐藤","age":30}]' | jq '.[] | select(.age > 28)'
# 出力結果
{
  "name": "佐藤",
  "age": 30
}
```

### データ変換
```bash
# オブジェクトの構造を変更
echo '{"name":"田中","age":30}' | jq '{user: .name, years: .age}'
# 出力結果
{
  "user": "田中",
  "years": 30
}
```

## 追加のヒント

- パイプ演算子 `|` を使って複数のフィルタを連結できます
  ```bash
  cat data.json | jq '.users[] | select(.active == true) | .name'
  ```

- 複雑なJSONを扱う場合は、まず `jq '.'` で全体構造を確認すると便利です

- `jq`のフィルタは強力ですが、複雑になりがちです。頻繁に使うフィルタはシェルの関数やエイリアスとして保存しておくと良いでしょう

- 大きなJSONファイルを扱う場合は、必要な部分だけを抽出することでパフォーマンスが向上します