# stat コマンド

ファイルやファイルシステムの詳細な情報を表示します。

## 概要

`stat` コマンドは、ファイルやディレクトリの詳細な情報（アクセス権、所有者、サイズ、タイムスタンプなど）を表示します。また、ファイルシステム全体の情報を確認することもできます。基本的なファイル情報だけでなく、iノード番号やブロック数など、より技術的な詳細も提供します。

## オプション

### **-f, --file-system**

ファイルシステムの情報を表示します。

```console
$ stat -f /
  ファイル: "/"
    ID: ffffffff0000000f 名前長: 255  タイプ: ext4
ブロックサイズ: 4096       基本ブロックサイズ: 4096
    ブロック: 総数: 6553600    空き: 4934630    利用可能: 4934630
   i ノード: 総数: 1638400    空き: 1499772
```

### **-c, --format=FORMAT**

指定したフォーマットで出力します。

```console
$ stat -c "%n %s %U" file.txt
file.txt 1024 user
```

### **-t, --terse**

簡潔な形式で出力します。

```console
$ stat -t file.txt
file.txt 1024 8 81a4 1000 1000 103 1682841600 1682841600 1682841600 4096 8 0 0
```

## 使用例

### 基本的なファイル情報の表示

```console
$ stat file.txt
  ファイル: file.txt
  サイズ: 1024      	ブロック: 8          IO ブロック: 4096   通常ファイル
デバイス: 801h/2049d	i ノード: 8193       リンク: 1
アクセス: (0644/-rw-r--r--)  Uid: ( 1000/    user)   Gid: ( 1000/    user)
アクセス: 2025-04-30 10:00:00.000000000 +0900
更新: 2025-04-30 10:00:00.000000000 +0900
変更: 2025-04-30 10:00:00.000000000 +0900
作成: -
```

### 複数ファイルの情報表示

```console
$ stat file1.txt file2.txt
  ファイル: file1.txt
  サイズ: 1024      	ブロック: 8          IO ブロック: 4096   通常ファイル
デバイス: 801h/2049d	i ノード: 8193       リンク: 1
アクセス: (0644/-rw-r--r--)  Uid: ( 1000/    user)   Gid: ( 1000/    user)
アクセス: 2025-04-30 10:00:00.000000000 +0900
更新: 2025-04-30 10:00:00.000000000 +0900
変更: 2025-04-30 10:00:00.000000000 +0900
作成: -

  ファイル: file2.txt
  サイズ: 2048      	ブロック: 8          IO ブロック: 4096   通常ファイル
デバイス: 801h/2049d	i ノード: 8194       リンク: 1
アクセス: (0644/-rw-r--r--)  Uid: ( 1000/    user)   Gid: ( 1000/    user)
アクセス: 2025-04-30 10:00:00.000000000 +0900
更新: 2025-04-30 10:00:00.000000000 +0900
変更: 2025-04-30 10:00:00.000000000 +0900
作成: -
```

### カスタムフォーマットでの出力

```console
$ stat -c "ファイル名: %n, サイズ: %s バイト, 所有者: %U, グループ: %G, 更新日時: %y" file.txt
ファイル名: file.txt, サイズ: 1024 バイト, 所有者: user, グループ: user, 更新日時: 2025-04-30 10:00:00.000000000 +0900
```

## ヒント:

### フォーマット指定子の活用

`-c` オプションで使用できる主なフォーマット指定子には、`%n`（ファイル名）、`%s`（サイズ）、`%U`（所有者）、`%G`（グループ）、`%y`（更新日時）などがあります。これらを組み合わせて必要な情報だけを抽出できます。

### シンボリックリンクの情報

シンボリックリンクの実際のターゲットではなく、リンク自体の情報を表示するには、`-L` オプションを使用しないでください。

### スクリプトでの利用

`stat` コマンドは、シェルスクリプト内でファイルの属性を確認する際に非常に便利です。特に `-c` オプションを使用すると、必要な情報だけを抽出できます。

## よくある質問

#### Q1. `stat` と `ls -l` の違いは何ですか？
A. `ls -l` は基本的なファイル情報（権限、所有者、サイズ、更新日時など）を表示しますが、`stat` はより詳細な情報（iノード番号、デバイス番号、アクセス日時、変更日時など）も表示します。

#### Q2. ファイルの最終アクセス日時だけを表示するにはどうすればいいですか？
A. `stat -c "%x" ファイル名` を使用します。

#### Q3. ファイルシステムの空き容量を確認するには？
A. `stat -f ファイルシステムのマウントポイント` を使用します。例えば、ルートファイルシステムの場合は `stat -f /` です。

#### Q4. macOSとLinuxでの `stat` コマンドの違いは何ですか？
A. macOSの `stat` コマンドはBSD由来で、Linuxの GNU coreutils の `stat` とはオプションやフォーマット指定子が異なります。macOSでは `-f` フォーマットオプションを使用し、Linuxでは `-c` を使用します。

## macOSでの注意点

macOSの `stat` コマンドはBSD系であり、GNU版とは構文が異なります。例えば、フォーマット指定には `-f` オプションを使用し、フォーマット指定子も異なります。

```console
$ stat -f "%N %z %Su" file.txt
file.txt 1024 user
```

また、macOSでは一部のタイムスタンプ（特に作成時間）が利用可能で、Linuxでは利用できない場合があります。

## 参考資料

https://www.gnu.org/software/coreutils/manual/html_node/stat-invocation.html

## 改訂履歴

- 2025/04/30 初版作成