# source コマンド

シェルスクリプトやコマンドを現在のシェル環境で実行します。

## 概要

`source` コマンドは、指定されたファイル内のコマンドを現在のシェル環境で読み込んで実行します。これは、環境変数の設定や関数の定義など、現在のシェルセッションに変更を適用したい場合に特に便利です。Bashでは、ドット演算子 (`.`) も `source` コマンドの別名として使用できます。

## オプション

`source` コマンドには多くのオプションはありませんが、基本的な使い方を説明します。

### **基本的な使い方**

ファイルを現在のシェル環境で実行します。

```console
$ source filename
```

または

```console
$ . filename
```

## 使用例

### 環境変数の設定

```console
$ cat env_vars.sh
export PROJECT_HOME=/path/to/project
export DEBUG_MODE=true

$ source env_vars.sh
$ echo $PROJECT_HOME
/path/to/project
```

### Bashの設定ファイルの再読み込み

```console
$ source ~/.bashrc
```

### 仮想環境のアクティベート（Python）

```console
$ source venv/bin/activate
(venv) $
```

## ヒント:

### `source` と実行の違い

スクリプトを直接実行（`./script.sh`）すると、新しいシェルプロセスで実行されるため、環境変数の変更は親シェルに影響しません。`source` を使うと現在のシェルで実行されるため、環境変数の変更が保持されます。

### 相対パスの使用

`source` コマンドは現在の作業ディレクトリを基準にファイルを探します。絶対パスを使用するか、相対パスが正しいことを確認してください。

### シェルの互換性

`source` は主にBashやZshなどのシェルで使用されます。シェルによっては構文や動作が異なる場合があるので注意してください。

## よくある質問

#### Q1. `source` と `.` の違いは何ですか？
A. 機能的には同じです。`.` はPOSIX標準で、`source` はBashの拡張機能ですが、多くの現代的なシェルでは両方が使えます。

#### Q2. スクリプトを `source` で実行すると何が起こりますか？
A. スクリプト内のコマンドが現在のシェル環境で実行され、設定された変数や関数が現在のセッションで利用可能になります。

#### Q3. `source` コマンドの戻り値は何ですか？
A. 実行されたスクリプトの最後のコマンドの終了ステータスが返されます。

#### Q4. スクリプトに引数を渡すことはできますか？
A. はい、`source script.sh arg1 arg2` のように引数を渡すことができます。スクリプト内では `$1`, `$2` などで参照できます。

## macOSでの注意点

macOSのデフォルトシェルはzshですが、`source` コマンドはBashと同様に動作します。ただし、一部のシステムスクリプトはBash固有の機能を使用している場合があるため、互換性の問題が発生する可能性があります。

## 参考資料

https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html

## 改訂履歴

- 2025/04/30 初版作成