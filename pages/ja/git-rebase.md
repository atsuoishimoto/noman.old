# git-rebase コマンド概要

`git rebase`は、コミット履歴を整理し、ブランチの起点を変更するコマンドです。これにより、履歴をクリーンに保ち、マージの複雑さを減らすことができます。

## オプション

### **-i, --interactive**:

対話モードでリベースを行います。コミットの並べ替え、編集、統合などが可能です。

例: `git rebase -i HEAD~3`（直近3つのコミットを対話的に操作）

### **--onto <newbase>**:

特定のコミットやブランチの上にリベースします。

例: `git rebase --onto main feature~3 feature`（featureブランチの特定範囲をmainブランチ上に移動）

### **--continue**:

コンフリクト解決後にリベースを続行します。

例: `git rebase --continue`

### **--abort**:

リベースを中止し、元の状態に戻します。

例: `git rebase --abort`

### **--skip**:

現在のコミットをスキップしてリベースを続行します。

例: `git rebase --skip`

## 使用例

### 基本的なリベース

```bash
# featureブランチをmainブランチにリベース
git checkout feature
git rebase main

# 結果: featureブランチのコミットがmainブランチの最新コミットの上に再適用される
```

### 対話的リベース

```bash
# 直近3つのコミットを対話的に操作
git rebase -i HEAD~3

# 以下のようなエディタが開く
# pick f7f3f6d コミットメッセージ1
# pick 310154e コミットメッセージ2
# pick a5f4a0d コミットメッセージ3
#
# コマンド:
# p, pick = コミットを使用
# r, reword = コミットを使用するがメッセージを変更
# e, edit = コミットを使用するが修正のために一時停止
# s, squash = コミットを使用するが前のコミットに統合
# f, fixup = squashと同様だがメッセージは破棄
# d, drop = コミットを削除
```

### 特定範囲のリベース

```bash
# featureブランチの特定範囲のコミットをmainブランチ上に移動
git rebase --onto main feature~3 feature

# 結果: featureブランチの最新3つのコミット以外がmainブランチの上に再適用される
```

## よくある質問

### Q1. リベースとマージの違いは何ですか？
A. リベースはコミット履歴を直線的に整理し、マージは履歴の分岐を保持します。リベースは履歴をクリーンに保ちますが、共有ブランチでは注意が必要です。

### Q2. リベース中にコンフリクトが発生した場合はどうすればよいですか？
A. コンフリクトを解決した後、`git add <ファイル名>`でファイルをステージングし、`git rebase --continue`でリベースを続行します。

### Q3. リベースを途中でやめたい場合はどうすればよいですか？
A. `git rebase --abort`を実行すると、リベース前の状態に戻ります。

### Q4. 既にプッシュしたブランチをリベースしても大丈夫ですか？
A. 他の人と共有しているブランチをリベースすると問題が発生する可能性があります。リベース後は`git push --force`が必要になりますが、チーム開発では注意が必要です。

### Q5. 対話的リベースでコミットを統合するにはどうすればよいですか？
A. `git rebase -i HEAD~n`を実行し、統合したいコミットの行を`squash`または`fixup`に変更します。

### Q6. リベース中に特定のコミットをスキップするにはどうすればよいですか？
A. 対話モードで該当コミットの行を`drop`に変更するか、コンフリクト発生時に`git rebase --skip`を使用します。

### Q7. リベースとチェリーピックの違いは何ですか？
A. リベースは一連のコミットを再適用しますが、チェリーピックは個別のコミットを選んで適用します。

### Q8. リベース後に元の状態に戻すにはどうすればよいですか？
A. リベース前のブランチポインタが`ORIG_HEAD`に保存されているため、`git reset --hard ORIG_HEAD`で戻せます。

### Q9. 長いブランチをリベースする際の注意点は？
A. コンフリクトの可能性が高まるため、小さな範囲に分けてリベースすることをお勧めします。

### Q10. `git pull --rebase`とは何ですか？
A. リモートの変更を取得した後、ローカルの変更をリベースで適用します。これにより、マージコミットを作らずに履歴を整理できます。

## 追加のメモ

- リベースは履歴を書き換えるため、既にプッシュした共有ブランチでは使用に注意が必要です。
- 大規模なリベースの前にはブランチをバックアップしておくと安心です。
- `git config pull.rebase true`を設定すると、`git pull`時に自動的にリベースが使用されます。
- 複雑なリベースを行う前に、Gitの仕組みをよく理解しておくことをお勧めします。