{
  "id": "msg_01DkU5hudMsG7iZBgcMPRicb",
  "content": [
    {
      "text": "# vmstat command\n\nReport virtual memory statistics.\n\n## Overview\n\n`vmstat` displays information about system memory, processes, paging, block I/O, traps, and CPU activity. It provides a snapshot of system resource usage and is particularly useful for identifying performance bottlenecks related to memory, CPU, or I/O.\n\n## Options\n\n### **-a**\n\nDisplay active and inactive memory\n\n```console\n$ vmstat -a\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free  inact active   si   so    bi    bo   in   cs us sy id wa st\n 1  0      0 7123456 2345678 1234567    0    0     0     2   51   92  1  1 98  0  0\n```\n\n### **-d**\n\nDisplay disk statistics\n\n```console\n$ vmstat -d\ndisk- ------------reads------------ ------------writes----------- -----IO------\n       total merged sectors      ms  total merged sectors      ms    cur    sec\nsda    12687   2713  972258   13364  10347   9944 1766952   23694      0     11\n```\n\n### **-s**\n\nDisplay table of various event counters and memory statistics\n\n```console\n$ vmstat -s\n      8169348 K total memory\n       986168 K used memory\n      1247848 K active memory\n      2345678 K inactive memory\n      7183180 K free memory\n        16384 K buffer memory\n      1983616 K swap cache\n      8388604 K total swap\n            0 K used swap\n      8388604 K free swap\n       123456 non-nice user cpu ticks\n          234 nice user cpu ticks\n        56789 system cpu ticks\n     12345678 idle cpu ticks\n         1234 IO-wait cpu ticks\n            0 IRQ cpu ticks\n          123 softirq cpu ticks\n            0 stolen cpu ticks\n       567890 pages paged in\n      1234567 pages paged out\n            0 pages swapped in\n            0 pages swapped out\n      5678901 interrupts\n     12345678 CPU context switches\n   1234567890 boot time\n        12345 forks\n```\n\n### **-S**\n\nSpecify unit size (k, K, m, M) for displaying memory values\n\n```console\n$ vmstat -S M\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 1  0      0   6953      0   1937    0    0     0     2   51   92  1  1 98  0  0\n```\n\n### **interval [count]**\n\nContinuously display statistics at specified intervals (in seconds)\n\n```console\n$ vmstat 2 5\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 1  0      0 7123456  16384 1983616    0    0     0     2   51   92  1  1 98  0  0\n 0  0      0 7123456  16384 1983616    0    0     0     0   45   89  0  0 100  0  0\n 0  0      0 7123456  16384 1983616    0    0     0     0   46   88  0  0 100  0  0\n 0  0      0 7123456  16384 1983616    0    0     0     0   45   87  0  0 100  0  0\n 0  0      0 7123456  16384 1983616    0    0     0    12   48   90  0  0 99  1  0\n```\n\n## Usage Examples\n\n### Basic memory and CPU statistics\n\n```console\n$ vmstat\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 1  0      0 7123456  16384 1983616    0    0     0     2   51   92  1  1 98  0  0\n```\n\n### Monitoring system performance every 5 seconds for 10 iterations\n\n```console\n$ vmstat 5 10\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 1  0      0 7123456  16384 1983616    0    0     0     2   51   92  1  1 98  0  0\n 0  0      0 7123456  16384 1983616    0    0     0     0   45   89  0  0 100  0  0\n[output continues for 8 more iterations]\n```\n\n### Displaying disk statistics with timestamps\n\n```console\n$ vmstat -d -t\ndisk- ------------reads------------ ------------writes----------- -----IO------   ----timestamp----\n       total merged sectors      ms  total merged sectors      ms    cur    sec\nsda    12687   2713  972258   13364  10347   9944 1766952   23694      0     11   2025-05-05 10:15:30\n```\n\n## Tips\n\n### Understanding the Output Columns\n\n- **procs**: `r` shows runnable processes, `b` shows blocked processes\n- **memory**: `swpd` is virtual memory used, `free` is idle memory\n- **swap**: `si` is memory swapped in, `so` is memory swapped out\n- **io**: `bi` is blocks received from block devices, `bo` is blocks sent\n- **system**: `in` is interrupts per second, `cs` is context switches\n- **cpu**: percentages of CPU time in user mode (`us`), system mode (`sy`), idle (`id`), waiting for I/O (`wa`), and stolen by hypervisor (`st`)\n\n### First Line vs. Subsequent Lines\n\nThe first line of `vmstat` output shows averages since the last reboot, while subsequent lines show activity during the specified interval. For real-time analysis, focus on the lines after the first one.\n\n### Identifying Memory Pressure\n\nHigh values in the `si` and `so` columns indicate the system is swapping memory to disk, which can severely impact performance. This suggests you may need more RAM or need to optimize memory usage.\n\n### Detecting I/O Bottlenecks\n\nHigh values in the `wa` column of CPU statistics indicate processes are waiting for I/O operations to complete. This could point to disk bottlenecks.\n\n## Frequently Asked Questions\n\n#### Q1. What does a high value in the 'r' column indicate?\nA. A high number in the 'r' column indicates many processes are waiting for CPU time, suggesting CPU contention or insufficient CPU resources.\n\n#### Q2. How can I interpret swap activity in vmstat?\nA. The 'si' and 'so' columns show swap-in and swap-out activity. Any non-zero values indicate the system is using swap space, which may slow performance. Consistent high values suggest memory shortage.\n\n#### Q3. What's the difference between 'buff' and 'cache' in the memory section?\nA. 'buff' (buffer) is memory used for file system metadata and 'cache' is memory used for file contents. Both are used to improve file system performance and can be reclaimed when applications need memory.\n\n#### Q4. How do I monitor disk I/O with vmstat?\nA. Use `vmstat -d` to display detailed disk statistics including reads, writes, and I/O times.\n\n## References\n\nhttps://man7.org/linux/man-pages/man8/vmstat.8.html\n\n## Revisions\n\n- 2025/05/05 First revision",
      "type": "text"
    }
  ],
  "model": "claude-3-7-sonnet-20250219",
  "role": "assistant",
  "stop_reason": "end_turn",
  "stop_sequence": null,
  "type": "message",
  "usage": {
    "cache_creation_input_tokens": 0,
    "cache_read_input_tokens": 0,
    "input_tokens": 1633,
    "output_tokens": 1927
  }
}