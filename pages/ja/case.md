# case コマンド概要

`case` は、シェルスクリプト内で条件分岐を行うための構文です。パターンマッチングを使用して、与えられた値に基づいて異なる処理を実行します。

## オプション

`case` はコマンドではなくシェル構文のため、オプションはありません。代わりに、基本的な構文と使い方を説明します。

### **基本構文**

```bash
case 値 in
  パターン1)
    コマンド1
    ;;
  パターン2)
    コマンド2
    ;;
  *)
    デフォルトコマンド
    ;;
esac
```

- `値` は評価される変数や文字列
- `パターン` はワイルドカードを含むことができるマッチングパターン
- `;;` は各ケースの終了を示す
- `*` はどのパターンにも一致しない場合のデフォルト処理
- `esac` は `case` 構文の終了を示す（`case` を逆さまに書いたもの）

## 使用例

### 基本的な使い方

```bash
#!/bin/bash
fruit="りんご"

case "$fruit" in
  "りんご")
    echo "これはりんごです"
    ;;
  "バナナ")
    echo "これはバナナです"
    ;;
  "オレンジ")
    echo "これはオレンジです"
    ;;
  *)
    echo "不明な果物です"
    ;;
esac

# 出力: これはりんごです
```

### 複数のパターンマッチング

```bash
#!/bin/bash
day="月"

case "$day" in
  "月"|"火"|"水"|"木"|"金")
    echo "平日です"
    ;;
  "土"|"日")
    echo "週末です"
    ;;
  *)
    echo "無効な曜日です"
    ;;
esac

# 出力: 平日です
```

### ワイルドカードの使用

```bash
#!/bin/bash
filename="document.txt"

case "$filename" in
  *.txt)
    echo "テキストファイルです"
    ;;
  *.jpg|*.png|*.gif)
    echo "画像ファイルです"
    ;;
  *.sh)
    echo "シェルスクリプトです"
    ;;
  *)
    echo "不明なファイル形式です"
    ;;
esac

# 出力: テキストファイルです
```

### コマンドライン引数の処理

```bash
#!/bin/bash
# このスクリプトを example.sh とする

case "$1" in
  "start")
    echo "サービスを開始します"
    ;;
  "stop")
    echo "サービスを停止します"
    ;;
  "restart")
    echo "サービスを再起動します"
    ;;
  *)
    echo "使用法: $0 {start|stop|restart}"
    exit 1
    ;;
esac

# 実行例: ./example.sh start
# 出力: サービスを開始します
```

## よくある質問

### Q1. `case` と `if-elif-else` の違いは何ですか？
A. `case` は主にパターンマッチングに特化しており、複数の文字列パターンを簡潔に比較できます。`if-elif-else` はより汎用的で、複雑な条件式を扱えますが、多くの文字列比較を行う場合は `case` の方が読みやすくなります。

### Q2. `case` で正規表現は使えますか？
A. 基本的な `case` では完全な正規表現はサポートしていませんが、ワイルドカード（`*`, `?`）やパターンマッチングは使用できます。より高度な正規表現が必要な場合は、`=~` 演算子を使った `if` 文や `grep` コマンドを検討してください。

### Q3. 複数のパターンで同じ処理を実行するにはどうすればいいですか？
A. パイプ記号 `|` で複数のパターンを区切ることで、同じ処理を実行できます（例: `"パターン1"|"パターン2")`）。

### Q4. `;;` と `;&` と `;;&` の違いは何ですか？
A. `;;` は通常のケース終了、`;&` は次のケースも無条件に実行（フォールスルー）、`;;&` はパターンが一致した場合に次のケースも評価します。ただし `;&` と `;;&` は Bash 4.0 以降でのみ使用可能です。

## 追加のヒント

- `case` 文は特にコマンドライン引数の処理やメニュー選択の実装に適しています。
- 大文字と小文字を区別せずにマッチングしたい場合は、変数を小文字に変換してから比較することができます：`case "${変数,,}" in`
- 複雑なスクリプトでは、`case` 文をネストさせることも可能ですが、可読性のために避けた方が良いでしょう。
- `case` 文の中で変数を設定したり、関数を呼び出したりすることもできます。