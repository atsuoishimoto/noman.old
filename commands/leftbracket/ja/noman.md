# `[` コマンド概要

`[` コマンドは条件式を評価するためのUnixコマンドで、シェルスクリプト内での条件分岐に使用されます。実際には `test` コマンドの別名として機能します。

## オプション

`[` コマンド自体にはオプションはありませんが、様々な条件演算子を使用して比較や評価を行います。

### **ファイル関連の条件演算子**:

ファイルの存在や種類、権限などを確認します。

```bash
$ [ -f /etc/passwd ] && echo "ファイルが存在します"
ファイルが存在します

$ [ -d /etc ] && echo "ディレクトリが存在します"
ディレクトリが存在します
```

### **文字列関連の条件演算子**:

文字列の比較や空文字列のチェックを行います。

```bash
$ name="Taro"
$ [ "$name" = "Taro" ] && echo "名前は一致します"
名前は一致します

$ [ -z "$empty_var" ] && echo "変数は空です"
変数は空です
```

### **数値比較の条件演算子**:

数値の大小比較を行います。

```bash
$ age=25
$ [ $age -gt 20 ] && echo "20歳より大きいです"
20歳より大きいです
```

## 使用例

### 基本的な使用方法

```bash
$ [ 条件式 ] && 真の場合の処理 || 偽の場合の処理
```

### if文での使用例

```bash
$ if [ -f /etc/hosts ]; then
>   echo "hostsファイルが存在します"
> else
>   echo "hostsファイルが存在しません"
> fi
hostsファイルが存在します
```

### 複数条件の組み合わせ

```bash
$ age=25
$ [ $age -ge 20 -a $age -lt 30 ] && echo "20代です"
20代です
```

## よく使われる条件演算子

### ファイル関連
- `-f ファイル`: ファイルが存在し、通常ファイルである
- `-d ディレクトリ`: ディレクトリが存在する
- `-e パス`: ファイルまたはディレクトリが存在する
- `-r ファイル`: ファイルが読み取り可能
- `-w ファイル`: ファイルが書き込み可能
- `-x ファイル`: ファイルが実行可能

### 文字列関連
- `文字列1 = 文字列2`: 文字列が等しい
- `文字列1 != 文字列2`: 文字列が等しくない
- `-z 文字列`: 文字列が空
- `-n 文字列`: 文字列が空でない

### 数値関連
- `数値1 -eq 数値2`: 数値が等しい
- `数値1 -ne 数値2`: 数値が等しくない
- `数値1 -gt 数値2`: 数値1が数値2より大きい
- `数値1 -ge 数値2`: 数値1が数値2以上
- `数値1 -lt 数値2`: 数値1が数値2より小さい
- `数値1 -le 数値2`: 数値1が数値2以下

### 論理演算子
- `-a`: AND（かつ）
- `-o`: OR（または）
- `!`: NOT（否定）

## よくある質問

### Q1. `[` と `[[` の違いは何ですか？
A. `[` は標準的なPOSIXの `test` コマンドで、多くのシェルで使えます。一方 `[[` はBashなどの拡張機能で、より高度な条件式が使えますが、すべてのシェルで使えるわけではありません。

### Q2. `[` コマンドの最後に `]` が必要なのはなぜですか？
A. `[` は実際にはコマンドであり、`]` はその最後の引数として必要です。構文的に対称性を持たせるためのデザインです。

### Q3. 条件式で変数を使う際の注意点はありますか？
A. 変数は必ず二重引用符（`"`）で囲むことをお勧めします。空白を含む変数や空の変数を正しく処理するために重要です。

## 追加のヒント

- `[` コマンドでは、各演算子や値の間にスペースが必要です。例えば `[$var="value"]` ではなく `[ $var = "value" ]` と書く必要があります。
- シェルスクリプトでは、`if [ 条件 ]; then` の形式が一般的ですが、`&&` や `||` を使った短縮形も便利です。
- 複雑な条件式を書く場合は、Bashなどのシェルでは `[[` を使うとより直感的に書けることがあります。
- エラーを避けるため、変数が未定義の可能性がある場合は `-z "${変数+x}"` のようなパターンを使うと安全です。