{
  "id": "msg_011oqJds7aakbVnXgSFDLzBo",
  "content": [
    {
      "text": "# getopt command\n\nParse command-line options in shell scripts.\n\n## Overview\n\n`getopt` is a command-line utility that parses command-line arguments according to a specified format, making it easier to handle options in shell scripts. It standardizes option processing by rearranging the arguments into a canonical form that can be processed more easily.\n\n## Options\n\n### **-o, --options**\n\nSpecifies the short options to be recognized\n\n```console\n$ getopt -o ab:c:: -- -a -b value -c\n -a -b 'value' -c -- \n```\n\n### **-l, --longoptions**\n\nSpecifies the long options to be recognized\n\n```console\n$ getopt -o a -l alpha,beta: -- --alpha --beta=value\n -a --beta 'value' -- \n```\n\n### **-n, --name**\n\nSets the name used in error messages\n\n```console\n$ getopt -n myscript -o a -- -x\nmyscript: invalid option -- 'x'\n```\n\n### **-q, --quiet**\n\nSuppresses error messages\n\n```console\n$ getopt -q -o a -- -x\n -- 'x'\n```\n\n### **-Q, --quiet-output**\n\nSuppresses normal output (useful when checking for valid options)\n\n```console\n$ getopt -Q -o a -- -a\n```\n\n### **-u, --unquoted**\n\nProduces unquoted output (not recommended)\n\n```console\n$ getopt -u -o a:b: -- -a foo -b bar\n -a foo -b bar -- \n```\n\n### **-T, --test**\n\nTest mode: outputs the parsed parameters and exits\n\n```console\n$ getopt -T -o a:b: -- -a foo -b bar\ngetopt -o 'a:b:' -- '-a' 'foo' '-b' 'bar'\n```\n\n## Usage Examples\n\n### Basic Option Parsing in a Shell Script\n\n```console\n$ cat example.sh\n#!/bin/bash\nOPTS=$(getopt -o ab:c: --long alpha,beta:,gamma: -n 'example.sh' -- \"$@\")\neval set -- \"$OPTS\"\n\nwhile true; do\n  case \"$1\" in\n    -a | --alpha ) ALPHA=1; shift ;;\n    -b | --beta ) BETA=\"$2\"; shift 2 ;;\n    -c | --gamma ) GAMMA=\"$2\"; shift 2 ;;\n    -- ) shift; break ;;\n    * ) break ;;\n  esac\ndone\n\necho \"Alpha: $ALPHA\"\necho \"Beta: $BETA\"\necho \"Gamma: $GAMMA\"\necho \"Remaining arguments: $@\"\n\n$ ./example.sh -a --beta=value arg1 arg2\nAlpha: 1\nBeta: value\nGamma: \nRemaining arguments: arg1 arg2\n```\n\n### Handling Required Options\n\n```console\n$ cat required.sh\n#!/bin/bash\nOPTS=$(getopt -o f: --long file: -n 'required.sh' -- \"$@\")\neval set -- \"$OPTS\"\n\nFILE=\"\"\nwhile true; do\n  case \"$1\" in\n    -f | --file ) FILE=\"$2\"; shift 2 ;;\n    -- ) shift; break ;;\n    * ) break ;;\n  esac\ndone\n\nif [ -z \"$FILE\" ]; then\n  echo \"Error: -f/--file option is required\"\n  exit 1\nfi\n\necho \"Processing file: $FILE\"\n\n$ ./required.sh -f data.txt\nProcessing file: data.txt\n\n$ ./required.sh\nError: -f/--file option is required\n```\n\n## Tips:\n\n### Use Enhanced getopt\n\nModern Linux systems use enhanced getopt which supports long options. The traditional getopt on some systems (like macOS) may not support all features.\n\n### Always Quote Variables\n\nWhen passing arguments to getopt, always quote the variables to handle spaces correctly:\n```bash\ngetopt -o a:b: -- \"$@\"\n```\n\n### Handle Errors Properly\n\nUse the `-n` option to provide a script name for error messages, and check getopt's exit status to handle invalid options:\n```bash\nOPTS=$(getopt -o a:b: -n 'myscript' -- \"$@\") || exit 1\n```\n\n### Understand Option Syntax\n\nIn the option string:\n- A single letter means a flag option (e.g., `-a`)\n- A letter followed by a colon means an option with a required argument (e.g., `-b value`)\n- A letter followed by two colons means an option with an optional argument (e.g., `-c[value]`)\n\n## Frequently Asked Questions\n\n#### Q1. What's the difference between `getopt` and `getopts`?\nA. `getopt` is an external command that supports both short and long options, while `getopts` is a shell builtin that only supports short options but is more portable across different Unix-like systems.\n\n#### Q2. Why does my script fail with \"getopt: invalid option\" errors?\nA. You might be using the traditional getopt (common on macOS) which doesn't support long options or other enhanced features. Try using the enhanced getopt available on most Linux distributions.\n\n#### Q3. How do I handle options with optional arguments?\nA. Use double colons in the option specification: `-o a::` for short options or `--longoptions=alpha::` for long options.\n\n#### Q4. How do I separate options from non-option arguments?\nA. Use `--` to mark the end of options. Any arguments after `--` will be treated as non-option arguments.\n\n## References\n\nhttps://man7.org/linux/man-pages/man1/getopt.1.html\n\n## Revisions\n\n- 2025/05/05 First revision",
      "type": "text"
    }
  ],
  "model": "claude-3-7-sonnet-20250219",
  "role": "assistant",
  "stop_reason": "end_turn",
  "stop_sequence": null,
  "type": "message",
  "usage": {
    "cache_creation_input_tokens": 0,
    "cache_read_input_tokens": 0,
    "input_tokens": 1633,
    "output_tokens": 1379
  }
}