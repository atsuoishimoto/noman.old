# less コマンド

テキストファイルを画面単位で閲覧するためのページャー。

## 概要

`less` コマンドは、テキストファイルの内容を対話的に表示するためのページャーです。大きなファイルでも効率的に閲覧できるよう、ファイル全体をメモリに読み込まずに表示します。上下にスクロールしたり、テキスト内を検索したりすることができ、`more` コマンドの改良版として多くの追加機能を備えています。

## オプション

### **-N（行番号表示）**

各行の先頭に行番号を表示します。

```console
$ less -N example.txt
      1 これは例のテキストファイルです。
      2 lessコマンドで表示しています。
      3 行番号が表示されています。
```

### **-i（検索時に大文字小文字を区別しない）**

検索時に大文字と小文字を区別せずにマッチングします。

```console
$ less -i example.txt
# 「Example」と「example」の両方が検索結果にマッチする
```

### **-S（折り返しなし）**

長い行を折り返さずに表示します。横にスクロールして全体を見ることができます。

```console
$ less -S longlines.txt
# 長い行が折り返されずに表示される。右にスクロールして続きを見ることができる
```

### **-F（短いファイルの場合は終了）**

表示するファイルが1画面に収まる場合、自動的に終了します。

```console
$ less -F shortfile.txt
# ファイルが短い場合は表示後すぐに終了する
```

### **-R（ANSIカラーコードを解釈）**

ANSIカラーコードやその他の制御シーケンスを解釈して表示します。

```console
$ ls --color=always | less -R
# カラー表示されたlsの出力がlessでも色付きで表示される
```

### **-X（終了時に画面をクリアしない）**

less終了時に画面をクリアせず、表示内容を残します。

```console
$ less -X example.txt
# 終了後も表示内容が画面に残る
```

### **-g（検索結果のハイライト表示）**

検索結果の最初のマッチのみをハイライト表示します。

```console
$ less -g example.txt
# 検索後、最初にマッチした部分だけがハイライトされる
```

### **-G（検索結果のハイライト表示を無効化）**

検索結果のハイライト表示を無効にします。

```console
$ less -G example.txt
# 検索してもハイライト表示されない
```

### **-R（ディレクトリとその中身を再帰的に表示）**

指定されたディレクトリとその中のすべてのファイルやサブディレクトリを再帰的に表示します。

```console
$ less -R directory/
# ディレクトリ内のすべてのファイルとサブディレクトリが表示される
```

## 使用例

### 基本的なファイル閲覧

```console
$ less /var/log/syslog
# システムログファイルが表示される。スペースキーで次のページ、bキーで前のページに移動できる
```

### パイプを使った出力の閲覧

```console
$ ls -la | less
# lsコマンドの詳細出力をlessで閲覧できる
```

### 複数ファイルの閲覧

```console
$ less file1.txt file2.txt
# 複数のファイルを順番に閲覧できる。:nで次のファイル、:pで前のファイルに移動
```

### テキスト検索

```console
$ less example.txt
# ファイルを開いた後、/検索語 と入力してEnterを押すと検索できる
# nキーで次の検索結果、Nキーで前の検索結果に移動
```

## ヒント:

### 主なナビゲーションキー

- スペースキー: 1ページ下に移動
- b: 1ページ上に移動
- g: ファイルの先頭に移動
- G: ファイルの末尾に移動
- /パターン: 前方検索
- ?パターン: 後方検索
- n: 次の検索結果へ
- N: 前の検索結果へ
- q: 終了

### ファイル内の特定行に移動

行番号を指定して直接その行に移動できます。例えば、`100g`と入力すると100行目に移動します。

### マークの設定と利用

`m`キーに続けてアルファベット1文字を押すと、現在の位置にマークを設定できます。後で`` ` ``（バッククォート）に続けて同じ文字を押すと、そのマークに戻ることができます。

### 複数ファイルの効率的な閲覧

複数ファイルを指定した場合、`:n`で次のファイル、`:p`で前のファイルに移動できます。`:e ファイル名`で新しいファイルを開くこともできます。

## よくある質問

#### Q1. lessとmoreの違いは何ですか？
A. lessはmoreの拡張版で、前後のスクロール、検索機能、複数ファイルの閲覧など多くの機能を持っています。moreは基本的に前方向にしかスクロールできません。

#### Q2. lessで検索するにはどうすればいいですか？
A. `/検索語`と入力してEnterを押すと前方検索、`?検索語`と入力すると後方検索ができます。`n`キーで次の結果、`N`キーで前の結果に移動します。

#### Q3. lessを終了するにはどうすればいいですか？
A. `q`キーを押すと終了します。

#### Q4. lessで表示中にファイルの内容が変更された場合はどうなりますか？
A. lessは基本的に表示時点のファイル内容を表示します。変更を反映するには`r`または`R`キーを押してリロードする必要があります。

#### Q5. lessでテキストをコピーするにはどうすればいいですか？
A. lessにはコピー機能はありませんが、多くの端末エミュレータでは、マウスで選択するだけでテキストをコピーできます。

## macOSでの注意点

macOSのlessはGNU lessと若干動作が異なる場合があります。特に色付き表示のサポートが限定的なことがあります。Homebrewを使って`brew install less`でGNU lessをインストールすることで、より多くの機能を利用できます。

## 参考

https://www.greenwoodsoftware.com/less/

## 改訂履歴

- 2025/04/30 -Rオプションの説明を追加。
- 2025/04/30 初版作成。