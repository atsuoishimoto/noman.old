# git commit コマンド

変更をリポジトリに記録します。

## 概要

`git commit`は、ステージングエリア（インデックス）に追加された変更をリポジトリの履歴に永続的に記録するコマンドです。コミットはプロジェクトのスナップショットを作成し、各コミットにはメッセージを付けて変更内容を説明します。これはGitのバージョン管理の中心的な操作です。

## オプション

### **-m, --message**

コミットメッセージを指定します。これを使用すると、エディタが開かずに直接メッセージを入力できます。

```console
$ git commit -m "ログイン機能を追加"
[main 5d6e78a] ログイン機能を追加
 2 files changed, 65 insertions(+), 2 deletions(-)
```

### **-a, --all**

すでにGitで追跡されているファイルの変更をすべて自動的にステージングしてからコミットします。新規ファイルは含まれません。

```console
$ git commit -a -m "すべての変更をコミット"
[main 8f7e123] すべての変更をコミット
 3 files changed, 23 insertions(+), 5 deletions(-)
```

### **--amend**

直前のコミットを修正します。コミットメッセージの変更や、前回のコミットに変更を追加する場合に使用します。

```console
$ git commit --amend -m "修正したコミットメッセージ"
[main 5d6e78a] 修正したコミットメッセージ
 Date: Wed Apr 30 10:15:32 2025 +0900
 2 files changed, 65 insertions(+), 2 deletions(-)
```

### **-v, --verbose**

コミットメッセージエディタに差分情報を表示します。変更内容を確認しながらコミットメッセージを書くのに役立ちます。

```console
$ git commit -v
# エディタが開き、変更の差分が表示される
```

## 使用例

### 基本的なコミット

```console
$ git add index.html
$ git commit -m "ヘッダーのデザインを更新"
[main 3a4b5c6] ヘッダーのデザインを更新
 1 file changed, 15 insertions(+), 5 deletions(-)
```

### 変更をステージングしてからコミット（一括）

```console
$ git add .
$ git commit -m "複数のファイルを更新"
[main 7c8d9e0] 複数のファイルを更新
 3 files changed, 45 insertions(+), 12 deletions(-)
```

### 追跡済みファイルの変更を直接コミット

```console
$ git commit -am "バグ修正: ナビゲーションメニューの問題を解決"
[main 1b2c3d4] バグ修正: ナビゲーションメニューの問題を解決
 2 files changed, 8 insertions(+), 3 deletions(-)
```

## ヒント:

### 良いコミットメッセージを書く

コミットメッセージは簡潔で具体的に書きましょう。最初の行は50文字以内に収め、必要に応じて空行の後に詳細な説明を追加するとよいでしょう。「何を」変更したかだけでなく「なぜ」変更したかも記録すると将来役立ちます。

### 適切な粒度でコミットする

関連する変更を一つのコミットにまとめ、無関係な変更は別々のコミットに分けましょう。これにより、履歴が理解しやすくなり、必要に応じて特定の変更を取り消すことも容易になります。

### コミット前に変更を確認する

`git diff --staged`を使用して、コミットする内容を事前に確認することをお勧めします。意図しないファイルや変更がコミットされるのを防ぐことができます。

## よくある質問

#### Q1. コミットした後に、コミットメッセージを変更するにはどうすればよいですか？
A. `git commit --amend`を使用すると、直前のコミットのメッセージを変更できます。ただし、すでにリモートリポジトリにプッシュしたコミットを修正すると、強制プッシュが必要になるため注意が必要です。

#### Q2. 間違ってコミットしてしまった場合、取り消す方法はありますか？
A. `git reset HEAD~1`を使うと直前のコミットを取り消せます。`--soft`オプションを付けると変更はステージングエリアに残り、`--hard`オプションを付けると変更も破棄されます。

#### Q3. コミットしたけれど、ファイルを追加し忘れました。どうすればよいですか？
A. 忘れたファイルを`git add`でステージングし、`git commit --amend --no-edit`を実行すると、メッセージを変更せずに直前のコミットにファイルを追加できます。

#### Q4. コミットはいつプッシュすべきですか？
A. 論理的なまとまりができた時点でプッシュするとよいでしょう。ただし、チームの作業スタイルによって異なります。長時間プッシュせずにいると、コンフリクトのリスクが高まります。

## macOSでの注意点

macOSでは、ファイル名の大文字小文字の区別がデフォルトでは行われないため、ファイル名の大文字小文字だけを変更した場合、Gitが変更を検出しないことがあります。この場合は`git config core.ignorecase false`を設定するか、`git mv -f oldname tempname && git mv -f tempname newname`のように一時的な名前を経由して名前を変更することで対処できます。

## 参考

https://git-scm.com/docs/git-commit

## 改訂履歴

- 2025/04/30 初版作成