<!DOCTYPE html>
<html lang="ja">
  <head>
    
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      
        <link rel="stylesheet" href="/css/reset.css" />
        <link rel="stylesheet" href="/css/main.css" />
        <link rel="stylesheet" href="/css/search.css" />
      

      
        <script src="/ja/summary.js"></script>
        <script src="/js/search.js"></script>
        <script src="/js/language-switcher.js"></script>
      
      <title>
        
  rsync - noman

      </title>

      

      
    
  </head>
  <body>
    
  <nav>
    <div class="nav-logo">
      <a href="/"><img src="../../../images/white.png" height="50px" /></a>
    </div>
    <div class="nav-right">
      <div class="nav-search">
        <input id="nav-searchbox" type="text" placeholder="コマンドを検索" />
      </div>
      <div class="nav-links">
        <a href="/ja/commandlist.html">Commands</a>
        <span id="language-switcher"></span>
      </div>
    </div>
  </nav>

  <div class="content">
    <main>
      
  <h1>rsync コマンド</h1>
<p>ファイルやディレクトリをローカルまたはリモート間で同期します。</p>
<h2>概要</h2>
<p><code>rsync</code>は、高速で多機能なファイルコピーおよび同期ツールで、ローカルまたはリモート接続を介して動作します。ソースとデスティネーション間の差分のみを転送することで、ディレクトリやホスト間でファイルを効率的に転送・同期するように設計されています。これにより、特に大きなファイルや頻繁に同期する場合には、通常のコピーコマンドよりも高速に処理できます。</p>
<h2>オプション</h2>
<h3><strong>-a, --archive</strong></h3>
<p>アーカイブモードで、ほぼすべての属性を保持します（-rlptgoDと同等）。バックアップ操作で最も一般的に使用されるオプションです。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-a<span style="color: #F8F8F8"> </span>/source/directory/<span style="color: #F8F8F8"> </span>/destination/directory/
</pre></div>
<h3><strong>-v, --verbose</strong></h3>
<p>詳細表示を増やし、転送されているファイルを表示します。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-av<span style="color: #F8F8F8"> </span>/source/directory/<span style="color: #F8F8F8"> </span>/destination/directory/
<span style="color: #000; font-style: italic">sending incremental file list</span>
<span style="color: #000; font-style: italic">file1.txt</span>
<span style="color: #000; font-style: italic">file2.txt</span>
<span style="color: #000; font-style: italic">directory/</span>
<span style="color: #000; font-style: italic">directory/file3.txt</span>

<span style="color: #000; font-style: italic">sent 1,234 bytes  received 42 bytes  2,552.00 bytes/sec</span>
<span style="color: #000; font-style: italic">total size is 10,240  speedup is 8.04</span>
</pre></div>
<h3><strong>-z, --compress</strong></h3>
<p>転送中にファイルデータを圧縮して、帯域幅の使用量を削減します。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-avz<span style="color: #F8F8F8"> </span>/source/directory/<span style="color: #F8F8F8"> </span>user@remote-host:/destination/directory/
</pre></div>
<h3><strong>-P, --partial --progress</strong></h3>
<p>転送中の進行状況を表示し、部分的に転送されたファイルを保持します。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-avP<span style="color: #F8F8F8"> </span>large_file.iso<span style="color: #F8F8F8"> </span>/backup/
<span style="color: #000; font-style: italic">sending incremental file list</span>
<span style="color: #000; font-style: italic">large_file.iso</span>
<span style="color: #000; font-style: italic">    852,492,288 100%   85.23MB/s    0:00:09 (xfr#1, to-chk=0/1)</span>
</pre></div>
<h3><strong>--delete</strong></h3>
<p>ソースに存在しないデスティネーション内のファイルを削除し、デスティネーションをソースの完全なミラーにします。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-av<span style="color: #F8F8F8"> </span>--delete<span style="color: #F8F8F8"> </span>/source/directory/<span style="color: #F8F8F8"> </span>/destination/directory/
</pre></div>
<h3><strong>-n, --dry-run</strong></h3>
<p>実際に変更を加えずに試験実行を行います。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-avn<span style="color: #F8F8F8"> </span>--delete<span style="color: #F8F8F8"> </span>/source/directory/<span style="color: #F8F8F8"> </span>/destination/directory/
<span style="color: #000; font-style: italic">sending incremental file list</span>
<span style="color: #000; font-style: italic">./</span>
<span style="color: #000; font-style: italic">file1.txt</span>
<span style="color: #000; font-style: italic">file2.txt</span>

<span style="color: #000; font-style: italic">sent 123 bytes  received 42 bytes  330.00 bytes/sec</span>
<span style="color: #000; font-style: italic">total size is 10,240  speedup is 62.07 (DRY RUN)</span>
</pre></div>
<h2>使用例</h2>
<h3>リモートサーバーへの同期</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-avz<span style="color: #F8F8F8"> </span>~/Documents/<span style="color: #F8F8F8"> </span>user@remote-server:/backup/documents/
<span style="color: #000; font-style: italic">sending incremental file list</span>
<span style="color: #000; font-style: italic">./</span>
<span style="color: #000; font-style: italic">report.docx</span>
<span style="color: #000; font-style: italic">presentation.pptx</span>
<span style="color: #000; font-style: italic">data.xlsx</span>

<span style="color: #000; font-style: italic">sent 2,345,678 bytes  received 1,234 bytes  469,382.40 bytes/sec</span>
<span style="color: #000; font-style: italic">total size is 2,340,000  speedup is 0.99</span>
</pre></div>
<h3>除外ファイルを指定したバックアップの作成</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-av<span style="color: #F8F8F8"> </span>--exclude<span style="color: #CE5C00; font-weight: bold">=</span><span style="color: #4E9A06">&#39;*.tmp&#39;</span><span style="color: #F8F8F8"> </span>--exclude<span style="color: #CE5C00; font-weight: bold">=</span><span style="color: #4E9A06">&#39;cache/&#39;</span><span style="color: #F8F8F8"> </span>/home/user/<span style="color: #F8F8F8"> </span>/mnt/backup/home/
</pre></div>
<h3>ウェブサイトのミラーリング</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-avz<span style="color: #F8F8F8"> </span>--delete<span style="color: #F8F8F8"> </span>user@remote-server:/var/www/html/<span style="color: #F8F8F8"> </span>/local/mirror/
</pre></div>
<h3>大きなファイル転送の再開</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-avP<span style="color: #F8F8F8"> </span>--partial<span style="color: #F8F8F8"> </span>user@remote-server:large_file.iso<span style="color: #F8F8F8"> </span>/downloads/
</pre></div>
<h2>ヒント:</h2>
<h3>末尾のスラッシュを注意して使用する</h3>
<p>ディレクトリをコピーする際、ソースの末尾にスラッシュ（<code>/source/</code>）をつけると「このディレクトリの内容をコピー」を意味し、スラッシュなし（<code>/source</code>）は「このディレクトリとその内容をコピー」を意味します。</p>
<h3>パスワードなし転送のためのSSH鍵の設定</h3>
<p>頻繁にリモート転送を行う場合は、SSH鍵認証を設定して、パスワードの入力を省略できます。</p>
<h3>バックグラウンド転送のための帯域制限</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>--bwlimit<span style="color: #CE5C00; font-weight: bold">=</span><span style="color: #0000CF; font-weight: bold">1000</span><span style="color: #F8F8F8"> </span>-av<span style="color: #F8F8F8"> </span>/source/<span style="color: #F8F8F8"> </span>/destination/
</pre></div>
<p>これにより転送速度が1000 KB/秒に制限され、すべての帯域幅を消費すべきでないバックグラウンド転送に役立ちます。</p>
<h3>ハードリンクを使用したスナップショットの作成</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>rsync<span style="color: #F8F8F8"> </span>-a<span style="color: #F8F8F8"> </span>--link-dest<span style="color: #CE5C00; font-weight: bold">=</span>/backup/previous<span style="color: #F8F8F8"> </span>/source/<span style="color: #F8F8F8"> </span>/backup/current/
</pre></div>
<p>これにより、変更されていないファイルを以前のバックアップにハードリンクすることで、容量効率の良いバックアップが作成できます。</p>
<h2>よくある質問</h2>
<h4>Q1. rsyncはscpやcpとどう違いますか？</h4>
<p>A. <code>cp</code>や<code>scp</code>と異なり、rsyncはファイル間の差分のみを転送するため、同じデータの後続の転送がはるかに高速になります。また、ファイル属性の保存や同期処理のためのより多くのオプションを提供しています。</p>
<h4>Q2. rsyncは中断された転送を再開できますか？</h4>
<p>A. はい、<code>--partial</code>オプション（または<code>-P</code>）を使用すると、rsyncは部分的に転送されたファイルを最初からやり直すのではなく、再開できます。</p>
<h4>Q3. rsyncがデスティネーションのファイルを削除しないようにするにはどうすればよいですか？</h4>
<p>A. デフォルトでは、rsyncはファイルを削除しません。ソースからファイルを追加または更新するだけです。ソースに存在しないデスティネーション内のファイルを削除するには、<code>--delete</code>オプションを明示的に指定する必要があります。</p>
<h4>Q4. rsyncが実際に何をするかを事前にテストするにはどうすればよいですか？</h4>
<p>A. <code>--dry-run</code>または<code>-n</code>オプションを使用すると、実際に変更を加えることなく、何が転送されるかを確認できます。</p>
<h4>Q5. rsyncは2つのリモートサーバー間でファイルを同期できますか？</h4>
<p>A. はい、ただしサーバーの1つでrsyncを実行するか、<code>--rsync-path</code>オプションを使用してリモートマシン上のrsyncへのパスを指定する必要があります。</p>
<h2>References</h2>
<p>https://download.samba.org/pub/rsync/rsync.html</p>
<h2>Revisions</h2>
<ul>
<li>2025/05/04 First revision</li>
</ul>


    </main>
  </div>

  <footer>
    <p>
      Copyright © 2025 noman project | <a href="https://github.com/atsuoishimoto/noman">GitHub</a> | MIT License
    </p>
  </footer>

  </body>
</html>