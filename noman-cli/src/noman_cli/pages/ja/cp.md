# cp コマンド

ファイルやディレクトリをコピーします。

## 概要

`cp`コマンドは、ファイルやディレクトリを別の場所にコピーするために使用されます。元のファイルはそのまま残り、指定した場所に同じ内容の新しいファイルが作成されます。単一のファイルのコピーから、複数のファイルやディレクトリ全体のコピーまで対応しています。

## オプション

### **-r, --recursive**

ディレクトリとその中身を再帰的にコピーします。ディレクトリをコピーする際には必須のオプションです。

```console
$ cp -r プロジェクト/ バックアップ/
# プロジェクトディレクトリとその中身がバックアップディレクトリにコピーされる
```

### **-i, --interactive**

既存のファイルを上書きする前に確認を求めます。誤って重要なファイルを上書きしないようにするのに役立ちます。

```console
$ cp -i 文書.txt 文書_バックアップ.txt
cp: overwrite '文書_バックアップ.txt'? y
# yと入力すると上書きされる
```

### **-v, --verbose**

コピー処理の詳細を表示します。何がコピーされているかを確認したい場合に便利です。

```console
$ cp -v 文書.txt 文書_バックアップ.txt
'文書.txt' -> '文書_バックアップ.txt'
```

### **-p, --preserve**

ファイルの属性（所有者、グループ、タイムスタンプ、モードなど）を保持します。

```console
$ cp -p 文書.txt 文書_バックアップ.txt
# 元のファイルの属性を保持してコピーされる
```

## 使用例

### 基本的なファイルのコピー

```console
$ cp 元ファイル.txt コピー先.txt
# 元ファイル.txtがコピー先.txtとしてコピーされる
```

### 複数ファイルを別のディレクトリにコピー

```console
$ cp ファイル1.txt ファイル2.txt 画像.jpg 目的ディレクトリ/
# 3つのファイルが目的ディレクトリにコピーされる
```

### ディレクトリ全体のコピー

```console
$ cp -r ソースディレクトリ/ 目的ディレクトリ/
# ソースディレクトリとその中身が目的ディレクトリにコピーされる
```

### 属性を保持しながら詳細表示でコピー

```console
$ cp -pvr プロジェクト/ バックアップ/
'プロジェクト/ファイル1.txt' -> 'バックアップ/ファイル1.txt'
'プロジェクト/ディレクトリ1/ファイル2.txt' -> 'バックアップ/ディレクトリ1/ファイル2.txt'
# 属性を保持しながらコピーし、処理の詳細が表示される
```

## ヒント:

### バックアップコピーの作成

`cp -b` オプションを使用すると、コピー先に既存のファイルがある場合、上書きする前にバックアップを作成します。これにより、重要なファイルを誤って上書きするリスクを減らせます。

### ワイルドカードの活用

特定のパターンに一致するファイルをコピーするには、ワイルドカードを使用できます。例えば、`cp *.txt 目的ディレクトリ/` はすべてのテキストファイルをコピーします。

### シンボリックリンクの扱い

デフォルトでは、`cp` はシンボリックリンクの内容ではなくリンク自体をコピーします。リンク先の内容をコピーするには、`-L` オプションを使用します。

### macOSでの注意点

macOSでは、`cp` コマンドの動作が若干異なる場合があります。特に、隠しファイル（ドットで始まるファイル）をコピーする際は、`-a` オプションを使用すると、属性やパーミッションを保持しながら隠しファイルも含めてコピーできます。

## よくある質問

#### Q1. `cp` と `mv` の違いは何ですか？
A. `cp` はファイルをコピーし、元のファイルはそのまま残ります。一方、`mv` はファイルを移動またはリネームし、元の場所からファイルがなくなります。

#### Q2. ディレクトリをコピーしようとすると「省略されました」というエラーが出るのはなぜですか？
A. ディレクトリをコピーするには `-r`（再帰的）オプションが必要です。`cp -r ソースディレクトリ 目的ディレクトリ` のように使用してください。

#### Q3. 既存のファイルを誤って上書きしないようにするにはどうすればよいですか？
A. `-i`（インタラクティブ）オプションを使用すると、既存のファイルを上書きする前に確認を求められます。`cp -i ソース 目的地` のように使用します。

#### Q4. ファイルの所有者やパーミッションも含めてコピーするにはどうすればよいですか？
A. `-p`（保存）オプションを使用すると、ファイルの属性（モード、所有権、タイムスタンプ）が保持されます。`cp -p ソース 目的地` のように使用します。

## 参考文献

https://www.gnu.org/software/coreutils/manual/html_node/cp-invocation.html

## 改訂履歴

- 2025/04/30 初版作成