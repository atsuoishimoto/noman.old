<h1>sed コマンド概要</h1>
<p><code>sed</code>（Stream EDitor）は、テキストファイルやストリームを処理するための強力なテキスト変換ツールです。パターンマッチングを使用してテキストを検索・置換することができます。</p>
<h2>オプション</h2>
<h3><strong>-e</strong>：複数の編集コマンドを指定</h3>
<p>複数の編集操作を一度に実行できます。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;Hello World&quot;</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>sed<span style="color: #F8F8F8"> </span>-e<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;s/Hello/Hi/&#39;</span><span style="color: #F8F8F8"> </span>-e<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;s/World/Everyone/&#39;</span>
Hi<span style="color: #F8F8F8"> </span>Everyone
</pre></div>
<h3><strong>-i</strong>：ファイルを直接編集</h3>
<p>ファイルを直接変更します（元のファイルを上書き）。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>sed<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;s/old/new/g&#39;</span><span style="color: #F8F8F8"> </span>file.txt
<span style="color: #8F5902; font-style: italic"># file.txtの「old」を「new」に置き換えて保存</span>
</pre></div>
<h3><strong>-n</strong>：自動出力を抑制</h3>
<p>マッチした行のみを出力します（デフォルトではすべての行が出力されます）。</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>sed<span style="color: #F8F8F8"> </span>-n<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;/pattern/p&#39;</span><span style="color: #F8F8F8"> </span>file.txt
<span style="color: #8F5902; font-style: italic"># 「pattern」を含む行のみを表示</span>
</pre></div>
<h2>使用例</h2>
<h3>基本的な置換</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;The quick brown fox&quot;</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>sed<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;s/brown/red/&#39;</span>
The<span style="color: #F8F8F8"> </span>quick<span style="color: #F8F8F8"> </span>red<span style="color: #F8F8F8"> </span>fox
<span style="color: #8F5902; font-style: italic"># 最初に出現する「brown」を「red」に置換</span>
</pre></div>
<h3>グローバル置換（g フラグ）</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span><span style="color: #204A87">echo</span><span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&quot;brown paper brown bag&quot;</span><span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>sed<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;s/brown/white/g&#39;</span>
white<span style="color: #F8F8F8"> </span>paper<span style="color: #F8F8F8"> </span>white<span style="color: #F8F8F8"> </span>bag
<span style="color: #8F5902; font-style: italic"># すべての「brown」を「white」に置換</span>
</pre></div>
<h3>特定の行を削除</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>cat<span style="color: #F8F8F8"> </span>file.txt
Line<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">1</span>
Line<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">2</span>
Line<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">3</span>
Line<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">4</span>

$<span style="color: #F8F8F8"> </span>sed<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;2d&#39;</span><span style="color: #F8F8F8"> </span>file.txt
Line<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">1</span>
Line<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">3</span>
Line<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">4</span>
<span style="color: #8F5902; font-style: italic"># 2行目を削除</span>
</pre></div>
<h3>特定のパターンを含む行を削除</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>sed<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;/pattern/d&#39;</span><span style="color: #F8F8F8"> </span>file.txt
<span style="color: #8F5902; font-style: italic"># 「pattern」を含む行を削除</span>
</pre></div>
<h3>範囲指定での編集</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>$<span style="color: #F8F8F8"> </span>sed<span style="color: #F8F8F8"> </span><span style="color: #4E9A06">&#39;2,4s/old/new/g&#39;</span><span style="color: #F8F8F8"> </span>file.txt
<span style="color: #8F5902; font-style: italic"># 2行目から4行目までの「old」を「new」に置換</span>
</pre></div>
<h2>よくある質問</h2>
<h3>Q1. sedの基本的な構文は？</h3>
<p>A. 基本構文は <code>sed 'コマンド' ファイル</code> です。コマンドには <code>s/検索パターン/置換テキスト/フラグ</code> などがあります。</p>
<h3>Q2. 元のファイルを変更せずに結果を確認するには？</h3>
<p>A. デフォルトでは、<code>sed</code>は標準出力に結果を表示し、元のファイルは変更しません。変更を適用するには <code>-i</code> オプションを使用します。</p>
<h3>Q3. 特定の行だけを編集するには？</h3>
<p>A. <code>sed '行番号s/old/new/'</code> のように行番号を指定できます。例：<code>sed '3s/old/new/' file.txt</code></p>
<h3>Q4. 正規表現を使用できますか？</h3>
<p>A. はい、<code>sed</code>は基本的な正規表現をサポートしています。例えば <code>sed 's/[0-9]\+/NUM/g'</code> は数字を「NUM」に置き換えます。</p>
<h2>追加情報</h2>
<ul>
<li>MacOSの<code>sed</code>はBSD版で、GNU版と若干動作が異なります。特に <code>-i</code> オプションでは、MacOSでは <code>-i ''</code> のように空の拡張子を指定する必要があります。</li>
<li>複雑な置換には、<code>&amp;</code>を使って一致したパターン全体を参照できます：<code>sed 's/hello/&amp; world/'</code></li>
<li>バックアップを作成しながら編集するには：<code>sed -i.bak 's/old/new/g' file.txt</code>（file.txt.bakというバックアップが作成されます）</li>
</ul>
