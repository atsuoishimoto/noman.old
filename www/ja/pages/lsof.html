<!DOCTYPE html>
<html lang="ja">
  <head>
    
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      
        <link rel="stylesheet" href="/css/reset.css" />
        <link rel="stylesheet" href="/css/main.css" />
        <link rel="stylesheet" href="/css/search.css" />
      

      
        <script src="/ja/summary.js"></script>
        <script src="/js/search.js"></script>
        <script src="/js/language-switcher.js"></script>
      
      <title>
        
  lsof - noman

      </title>

      

      
    
  </head>
  <body>
    
  <nav>
    <div class="nav-logo">
      <a href="/"><img src="../../../images/white.png" height="50px" /></a>
    </div>
    <div class="nav-right">
      <div class="nav-search">
        <input id="nav-searchbox" type="text" placeholder="コマンドを検索" />
      </div>
      <div class="nav-links">
        <a href="/ja/commandlist.html">Commands</a>
        <span id="language-switcher"></span>
      </div>
    </div>
  </nav>

  <div class="content">
    <main>
      
  <h1>lsof コマンド</h1>
<p>システム上で開いているファイルとそれを開いているプロセスを一覧表示します。</p>
<h2>概要</h2>
<p><code>lsof</code>（List Open Files）は、システム上で実行中のプロセスによって現在開かれているファイルに関する情報を表示します。特定のファイルを開いているプロセスや、特定のプロセスが開いているファイル、その他のファイル使用状況の詳細を表示できます。このコマンドは、システム管理者や開発者がトラブルシューティングやシステムリソースの監視を行う際に特に役立ちます。</p>
<h2>オプション</h2>
<h3><strong>-p PID</strong></h3>
<p>指定したプロセスIDが開いているファイルを一覧表示します</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>lsof<span style="color: #F8F8F8"> </span>-p<span style="color: #F8F8F8"> </span><span style="color: #0000CF; font-weight: bold">1234</span>
<span style="color: #000; font-style: italic">COMMAND   PID   USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span>
<span style="color: #000; font-style: italic">bash     1234   user  cwd    DIR    8,1     4096 131073 /home/user</span>
<span style="color: #000; font-style: italic">bash     1234   user  rtd    DIR    8,1     4096      2 /</span>
<span style="color: #000; font-style: italic">bash     1234   user  txt    REG    8,1  1113504 917562 /bin/bash</span>
</pre></div>
<h3><strong>-i [プロトコル][@ホスト名|ホストアドレス][:サービス|ポート]</strong></h3>
<p>インターネット接続用に開かれたファイルを一覧表示します（プロトコル、ホスト、ポートの指定は任意）</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>lsof<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>TCP:22
<span style="color: #000; font-style: italic">COMMAND  PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span>
<span style="color: #000; font-style: italic">sshd    1234    root    3u  IPv4  12345      0t0  TCP *:ssh (LISTEN)</span>
<span style="color: #000; font-style: italic">sshd    5678    root    4u  IPv6  23456      0t0  TCP *:ssh (LISTEN)</span>
</pre></div>
<h3><strong>-u ユーザー名</strong></h3>
<p>特定のユーザーが開いているファイルを一覧表示します</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>lsof<span style="color: #F8F8F8"> </span>-u<span style="color: #F8F8F8"> </span>john
<span style="color: #000; font-style: italic">COMMAND   PID   USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span>
<span style="color: #000; font-style: italic">bash     1234   john  cwd    DIR    8,1     4096 131073 /home/john</span>
<span style="color: #000; font-style: italic">chrome   2345   john   10u   REG    8,1    12345 262144 /tmp/file.tmp</span>
</pre></div>
<h3><strong>-c コマンド</strong></h3>
<p>指定したコマンド名を持つプロセスが開いているファイルを一覧表示します</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>lsof<span style="color: #F8F8F8"> </span>-c<span style="color: #F8F8F8"> </span>nginx
<span style="color: #000; font-style: italic">COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span>
<span style="color: #000; font-style: italic">nginx   1234 root  cwd    DIR    8,1     4096      2 /</span>
<span style="color: #000; font-style: italic">nginx   1234 root  txt    REG    8,1  1234567 917562 /usr/sbin/nginx</span>
<span style="color: #000; font-style: italic">nginx   1235 www   cwd    DIR    8,1     4096      2 /</span>
</pre></div>
<h3><strong>-t</strong></h3>
<p>プロセスIDのみを表示します（スクリプト作成に便利）</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>lsof<span style="color: #F8F8F8"> </span>-t<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>TCP:80
<span style="color: #000; font-style: italic">1234</span>
<span style="color: #000; font-style: italic">5678</span>
</pre></div>
<h2>使用例</h2>
<h3>特定のファイルを開いているプロセスを見つける</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>lsof<span style="color: #F8F8F8"> </span>/var/log/syslog
<span style="color: #000; font-style: italic">COMMAND  PID   USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span>
<span style="color: #000; font-style: italic">rsyslogd 854 syslog    7w   REG    8,1   256789 131074 /var/log/syslog</span>
</pre></div>
<h3>ネットワークポートをリッスンしているプロセスを確認する</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>lsof<span style="color: #F8F8F8"> </span>-i<span style="color: #F8F8F8"> </span>-P<span style="color: #F8F8F8"> </span>-n<span style="color: #F8F8F8"> </span><span style="color: #000; font-weight: bold">|</span><span style="color: #F8F8F8"> </span>grep<span style="color: #F8F8F8"> </span>LISTEN
<span style="color: #000; font-style: italic">sshd      1234    root    3u  IPv4  12345      0t0  TCP *:22 (LISTEN)</span>
<span style="color: #000; font-style: italic">nginx     2345    root    6u  IPv4  23456      0t0  TCP *:80 (LISTEN)</span>
<span style="color: #000; font-style: italic">mysqld    3456   mysql   10u  IPv4  34567      0t0  TCP 127.0.0.1:3306 (LISTEN)</span>
</pre></div>
<h3>特定のユーザーがディレクトリ内で開いているすべてのファイルを見つける</h3>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #8F5902">$ </span>lsof<span style="color: #F8F8F8"> </span>-u<span style="color: #F8F8F8"> </span>john<span style="color: #F8F8F8"> </span>/home/john
<span style="color: #000; font-style: italic">COMMAND  PID  USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span>
<span style="color: #000; font-style: italic">bash    1234  john  cwd    DIR    8,1     4096 131073 /home/john</span>
<span style="color: #000; font-style: italic">vim     2345  john    4u   REG    8,1    12345 262144 /home/john/document.txt</span>
</pre></div>
<h2>ヒント:</h2>
<h3>複数のフィルターを組み合わせる</h3>
<p>複数のオプションを組み合わせて結果を絞り込むことができます。例えば、<code>lsof -u ユーザー名 -i TCP</code>は特定のユーザーのTCP接続を表示します。</p>
<h3>使用中の削除されたファイルを見つける</h3>
<p><code>lsof +L1</code>を使用して、プロセスによってまだ開かれている削除済みファイルを見つけることができます。これはディスク容量の解放を妨げているプロセスを特定するのに役立ちます。</p>
<h3>ネットワーク接続の監視</h3>
<p><code>lsof -i</code>を定期的に使用して、ネットワーク接続を監視し、セキュリティ問題を示す可能性がある予期しないネットワークアクティビティを特定します。</p>
<h3>grepと組み合わせて対象を絞った結果を得る</h3>
<p><code>lsof</code>の出力を<code>grep</code>にパイプして特定の情報をフィルタリングできます。例えば、<code>lsof | grep &quot;/var/log&quot;</code>でログファイルにアクセスしているプロセスを見つけることができます。</p>
<h2>よくある質問</h2>
<h4>Q1. 特定のポートを使用しているプロセスを見つけるにはどうすればよいですか？</h4>
<p>A. <code>lsof -i:ポート番号</code>を使用します（例：HTTPポートの場合は<code>lsof -i:80</code>）。</p>
<h4>Q2. すべてのネットワーク接続を確認するにはどうすればよいですか？</h4>
<p>A. <code>lsof -i</code>を使用してすべてのネットワーク接続を表示します。<code>-P</code>を追加するとサービス名ではなくポート番号が表示されます。</p>
<h4>Q3. 特定のファイルにアクセスしているプロセスを見つけるにはどうすればよいですか？</h4>
<p>A. 単に<code>lsof /path/to/file</code>を実行すると、そのファイルを開いているすべてのプロセスが表示されます。</p>
<h4>Q4. 特定のプロセスが開いているすべてのファイルを見つけるにはどうすればよいですか？</h4>
<p>A. <code>lsof -p PID</code>を使用します。PIDは対象のプロセスIDです。</p>
<h2>References</h2>
<p>https://man7.org/linux/man-pages/man8/lsof.8.html</p>
<h2>Revisions</h2>
<ul>
<li>2025/05/04 初回リビジョン</li>
</ul>


    </main>
  </div>

  <footer>
    <p>
      Copyright © 2025 noman project | <a href="https://github.com/atsuoishimoto/noman">GitHub</a> | MIT License
    </p>
  </footer>

  </body>
</html>